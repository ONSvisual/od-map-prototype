//js
import{s as _e,e as ie,i as A,y as he,d as p,o as Lt,O as ee,P as te,h as T,j as v,k as z,x as w,A as re,f as M,a as K,g as P,c as H,R as ct,l as q,m as F,C as ye,E as ue,n as ne,S as _t,p as Le,F as Ce,r as Ct,u as Tt,v as It,w as Bt,H as Ot,T as De,I as Ve,U as Ee,V as we,G as Rt}from"../chunks/scheduler.3a2f20bc.js";import{S as me,i as ve,b as U,d as Q,m as Y,a as D,g as ge,t as j,c as ce,e as $,f as Te}from"../chunks/index.b332e88e.js";import{e as X,M as Gt,b as Se,d as de,g as Mt,c as Pt,r as At,a as Dt}from"../chunks/MapTooltip.svelte_svelte_type_style_lang.d60679b8.js";import{a as Vt,T as Nt}from"../chunks/Table.svelte_svelte_type_style_lang.ef39b0b2.js";import{b as jt}from"../chunks/paths.b150c641.js";import{b as zt,e as Re,f as Kt,d as Ht,s as Wt}from"../chunks/utils.368c67f1.js";async function qt({parent:t}){return await t()}const Cl=Object.freeze(Object.defineProperty({__proto__:null,load:qt},Symbol.toStringTag,{value:"Module"}));function Ne(t,e,n){const l=t.slice();return l[11]=e[n],l}function je(t,e,n){const l=t.slice();return l[14]=e[n],l[16]=n,l}function ze(t){let e,n,l,o,i,a,r=`${t[0]}px`,s=X(t[1]),d=[];for(let m=0;m<s.length;m+=1)d[m]=Ke(je(t,s,m));let f=X(t[4]),c=[];for(let m=0;m<f.length;m+=1)c[m]=He(Ne(t,f,m));return{c(){e=ee("svg"),n=ee("defs"),l=ee("linearGradient"),o=ee("stop"),i=ee("linearGradient"),a=ee("stop");for(let m=0;m<d.length;m+=1)d[m].c();for(let m=0;m<c.length;m+=1)c[m].c();this.h()},l(m){e=te(m,"svg",{viewBox:!0,preserveAspectRatio:!0,class:!0});var S=T(e);n=te(S,"defs",{});var g=T(n);l=te(g,"linearGradient",{id:!0});var y=T(l);o=te(y,"stop",{"stop-color":!0}),T(o).forEach(p),y.forEach(p),i=te(g,"linearGradient",{id:!0});var E=T(i);a=te(E,"stop",{"stop-color":!0,"stop-opacity":!0}),T(a).forEach(p),E.forEach(p);for(let R=0;R<d.length;R+=1)d[R].l(g);g.forEach(p);for(let R=0;R<c.length;R+=1)c[R].l(S);S.forEach(p),this.h()},h(){v(o,"stop-color",t[3]),v(l,"id","solid"),v(a,"stop-color",t[3]),v(a,"stop-opacity","0.2"),v(i,"id","transparent"),v(e,"viewBox","0 0 100 100"),v(e,"preserveAspectRatio","none"),v(e,"class","svelte-m0a6o9"),z(e,"height",r)},m(m,S){A(m,e,S),w(e,n),w(n,l),w(l,o),w(n,i),w(i,a);for(let g=0;g<d.length;g+=1)d[g]&&d[g].m(n,null);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(e,null)},p(m,S){if(S&8&&v(o,"stop-color",m[3]),S&8&&v(a,"stop-color",m[3]),S&10){s=X(m[1]);let g;for(g=0;g<s.length;g+=1){const y=je(m,s,g);d[g]?d[g].p(y,S):(d[g]=Ke(y),d[g].c(),d[g].m(n,null))}for(;g<d.length;g+=1)d[g].d(1);d.length=s.length}if(S&54){f=X(m[4]);let g;for(g=0;g<f.length;g+=1){const y=Ne(m,f,g);c[g]?c[g].p(y,S):(c[g]=He(y),c[g].c(),c[g].m(e,null))}for(;g<c.length;g+=1)c[g].d(1);c.length=f.length}S&1&&r!==(r=`${m[0]}px`)&&z(e,"height",r)},d(m){m&&p(e),re(d,m),re(c,m)}}}function Ke(t){let e,n,l,o;return{c(){e=ee("linearGradient"),n=ee("stop"),l=ee("stop"),this.h()},l(i){e=te(i,"linearGradient",{id:!0,gradientTransform:!0});var a=T(e);n=te(a,"stop",{offset:!0,"stop-color":!0,"stop-opacity":!0}),T(n).forEach(p),l=te(a,"stop",{offset:!0,"stop-color":!0,"stop-opacity":!0}),T(l).forEach(p),a.forEach(p),this.h()},h(){v(n,"offset","5%"),v(n,"stop-color",t[3]),v(n,"stop-opacity",t[16]===0?1:.2),v(l,"offset","95%"),v(l,"stop-color",t[3]),v(l,"stop-opacity",t[16]===0?.2:1),v(e,"id",o=t[14]+"_gradient"),v(e,"gradientTransform","rotate(90)")},m(i,a){A(i,e,a),w(e,n),w(e,l)},p(i,a){a&8&&v(n,"stop-color",i[3]),a&8&&v(l,"stop-color",i[3]),a&2&&o!==(o=i[14]+"_gradient")&&v(e,"id",o)},d(i){i&&p(e)}}}function He(t){let e,n,l;function o(...i){return t[8](t[11],...i)}return{c(){e=ee("path"),this.h()},l(i){e=te(i,"path",{d:!0,fill:!0}),T(e).forEach(p),this.h()},h(){v(e,"d",n=t[5](...t[1].map(o),t[11].value)),v(e,"fill",l="url(#"+(Array.isArray(t[2])?`${t[11][t[2][0]]===t[2][1]?"solid":"transparent"}`:typeof t[2]=="string"?`${t[11][t[1][0]]===t[2]&&t[11][t[1][1]]===t[2]?"solid":t[11][t[1][0]]===t[2]?`${t[1][0]}_gradient`:t[11][t[1][1]]===t[2]?`${t[1][1]}_gradient`:"transparent"}`:"solid")+")")},m(i,a){A(i,e,a)},p(i,a){t=i,a&50&&n!==(n=t[5](...t[1].map(o),t[11].value))&&v(e,"d",n),a&22&&l!==(l="url(#"+(Array.isArray(t[2])?`${t[11][t[2][0]]===t[2][1]?"solid":"transparent"}`:typeof t[2]=="string"?`${t[11][t[1][0]]===t[2]&&t[11][t[1][1]]===t[2]?"solid":t[11][t[1][0]]===t[2]?`${t[1][0]}_gradient`:t[11][t[1][1]]===t[2]?`${t[1][1]}_gradient`:"transparent"}`:"solid")+")")&&v(e,"fill",l)},d(i){i&&p(e)}}}function Ft(t){let e,n=t[4]&&ze(t);return{c(){n&&n.c(),e=ie()},l(l){n&&n.l(l),e=ie()},m(l,o){n&&n.m(l,o),A(l,e,o)},p(l,[o]){l[4]?n?n.p(l,o):(n=ze(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:he,o:he,d(l){l&&p(e),n&&n.d(l)}}}const Zt=100;function Xt(t,e,n){let{data:l}=e,{height:o=80}=e,{gap:i=10}=e,{keys:a=["from","to"]}=e,{highlight:r="a"}=e,{color:s="#27a0cc"}=e,d,f;function c(g,y){const E=Zt-i*(g.length-1);return function(R){const V=g.slice(1).reduce((O,b)=>R>=b?O+i:O,0);return R*(E/y)+V}}function m(g){let y=JSON.parse(JSON.stringify(g)),E={},R={},V={},O={};for(const b of a){E[b]={};for(const I of y)E[b][I[b]]||(E[b][I[b]]={key:I[b],size:0}),E[b][I[b]].size+=I.value;let L=0;for(const I of Object.keys(E[b]).sort((N,G)=>N.localeCompare(G)))E[b][I].start=L,E[b][I].current=L,L+=E[b][I].size,V[b]=L;R[b]=Object.keys(E[b]).map(I=>E[b][I].start),O[b]=c(R[b],V[b])}for(const b of y)for(const L of a)b[`${L}_start`]=E[L][b[L]].current,E[L][b[L]].current+=b.value;n(5,f=(b,L,I)=>`
			M ${O[a[0]](b)},0
			L ${O[a[0]](b+I-.1)},0
			C ${O[a[0]](b+I-.1)},40 ${O[a[1]](L+I-.1)},40 ${O[a[1]](L+I-.1)},80
			L ${O[a[1]](L+I/2)},100
			L ${O[a[1]](L)},80
			C ${O[a[1]](L)},40 ${O[a[0]](b)},40 ${O[a[0]](b)},0 Z`),n(4,d=y)}Lt(()=>m(l));const S=(g,y)=>g[`${y}_start`];return t.$$set=g=>{"data"in g&&n(6,l=g.data),"height"in g&&n(0,o=g.height),"gap"in g&&n(7,i=g.gap),"keys"in g&&n(1,a=g.keys),"highlight"in g&&n(2,r=g.highlight),"color"in g&&n(3,s=g.color)},t.$$.update=()=>{t.$$.dirty&64&&m(l)},[o,a,r,s,d,f,l,i,S]}class Jt extends me{constructor(e){super(),ve(this,e,Xt,Ft,_e,{data:6,height:0,gap:7,keys:1,highlight:2,color:3})}}function We(t){let e,n=t[2].areanm+"",l,o,i,a="Deselect",r,s,d,f,c,m,S,g,y,E,R;function V(_,u){return!_[1]||_[1]==="to"?Qt:Ut}let O=V(t),b=O(t),L=(!t[1]||t[1]==="from")&&qe(t);m=new Jt({props:{data:[{from:"a",to:"a",value:t[2].d.home+t[2].d.within},{from:"a",to:"b",value:t[2].d.resident-t[2].d.home-t[2].d.within},{from:"b",to:"a",value:t[2].d.workday-t[2].d.home-t[2].d.within}],highlight:t[1]==="from"?["to","a"]:t[1]==="to"?["from","a"]:"a"}});function I(_,u){return!_[1]||_[1]==="from"?$t:Yt}let N=I(t),G=N(t),h=(!t[1]||t[1]==="to")&&Fe(t);return{c(){e=M("h2"),l=q(n),o=K(),i=M("button"),i.textContent=a,r=K(),s=M("div"),b.c(),d=K(),L&&L.c(),f=K(),c=M("div"),U(m.$$.fragment),S=K(),G.c(),g=K(),h&&h.c(),this.h()},l(_){e=P(_,"H2",{class:!0});var u=T(e);l=F(u,n),o=H(u),i=P(u,"BUTTON",{class:!0,"data-svelte-h":!0}),ye(i)!=="svelte-1gfluqx"&&(i.textContent=a),u.forEach(p),r=H(_),s=P(_,"DIV",{class:!0});var C=T(s);b.l(C),d=H(C),L&&L.l(C),f=H(C),c=P(C,"DIV",{class:!0});var B=T(c);Q(m.$$.fragment,B),B.forEach(p),S=H(C),G.l(C),g=H(C),h&&h.l(C),C.forEach(p),this.h()},h(){v(i,"class","btn-link svelte-1ikto2t"),v(e,"class","svelte-1ikto2t"),v(c,"class","svelte-1ikto2t"),z(c,"grid-column","span 2"),z(c,"line-height",0),v(s,"class","info-grid svelte-1ikto2t")},m(_,u){A(_,e,u),w(e,l),w(e,o),w(e,i),A(_,r,u),A(_,s,u),b.m(s,null),w(s,d),L&&L.m(s,null),w(s,f),w(s,c),Y(m,c,null),w(s,S),G.m(s,null),w(s,g),h&&h.m(s,null),y=!0,E||(R=ue(i,"click",t[7]),E=!0)},p(_,u){(!y||u&4)&&n!==(n=_[2].areanm+"")&&ne(l,n),O===(O=V(_))&&b?b.p(_,u):(b.d(1),b=O(_),b&&(b.c(),b.m(s,d))),!_[1]||_[1]==="from"?L?L.p(_,u):(L=qe(_),L.c(),L.m(s,f)):L&&(L.d(1),L=null);const C={};u&4&&(C.data=[{from:"a",to:"a",value:_[2].d.home+_[2].d.within},{from:"a",to:"b",value:_[2].d.resident-_[2].d.home-_[2].d.within},{from:"b",to:"a",value:_[2].d.workday-_[2].d.home-_[2].d.within}]),u&2&&(C.highlight=_[1]==="from"?["to","a"]:_[1]==="to"?["from","a"]:"a"),m.$set(C),N===(N=I(_))&&G?G.p(_,u):(G.d(1),G=N(_),G&&(G.c(),G.m(s,g))),!_[1]||_[1]==="to"?h?h.p(_,u):(h=Fe(_),h.c(),h.m(s,null)):h&&(h.d(1),h=null)},i(_){y||(D(m.$$.fragment,_),y=!0)},o(_){j(m.$$.fragment,_),y=!1},d(_){_&&(p(e),p(r),p(s)),b.d(),L&&L.d(),$(m),G.d(),h&&h.d(),E=!1,R()}}}function Ut(t){let e,n,l,o=(t[2].d.home+t[2].d.within).toLocaleString()+"",i;return{c(){e=M("div"),n=q("Living and working here "),l=M("strong"),i=q(o),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=T(e);n=F(r,"Living and working here "),l=P(r,"STRONG",{});var s=T(l);i=F(s,o),s.forEach(p),r.forEach(p),this.h()},h(){v(e,"class","text-muted svelte-1ikto2t")},m(a,r){A(a,e,r),w(e,n),w(e,l),w(l,i)},p(a,r){r&4&&o!==(o=(a[2].d.home+a[2].d.within).toLocaleString()+"")&&ne(i,o)},d(a){a&&p(e)}}}function Qt(t){let e,n,l,o=t[2].d.resident.toLocaleString()+"",i;return{c(){e=M("div"),n=q("Living here "),l=M("strong"),i=q(o),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=T(e);n=F(r,"Living here "),l=P(r,"STRONG",{class:!0});var s=T(l);i=F(s,o),s.forEach(p),r.forEach(p),this.h()},h(){v(l,"class","text-big svelte-1ikto2t"),v(e,"class","svelte-1ikto2t")},m(a,r){A(a,e,r),w(e,n),w(e,l),w(l,i)},p(a,r){r&4&&o!==(o=a[2].d.resident.toLocaleString()+"")&&ne(i,o)},d(a){a&&p(e)}}}function qe(t){let e,n,l,o=(t[2].d.workday-t[2].d.home-t[2].d.within).toLocaleString()+"",i;return{c(){e=M("div"),n=q("Travelling from another area "),l=M("strong"),i=q(o),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=T(e);n=F(r,"Travelling from another area "),l=P(r,"STRONG",{});var s=T(l);i=F(s,o),s.forEach(p),r.forEach(p),this.h()},h(){v(e,"class","text-muted text-right svelte-1ikto2t")},m(a,r){A(a,e,r),w(e,n),w(e,l),w(l,i)},p(a,r){r&4&&o!==(o=(a[2].d.workday-a[2].d.home-a[2].d.within).toLocaleString()+"")&&ne(i,o)},d(a){a&&p(e)}}}function Yt(t){let e,n,l,o=(t[2].d.home+t[2].d.within).toLocaleString()+"",i;return{c(){e=M("div"),n=q("Living and working here "),l=M("strong"),i=q(o),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=T(e);n=F(r,"Living and working here "),l=P(r,"STRONG",{});var s=T(l);i=F(s,o),s.forEach(p),r.forEach(p),this.h()},h(){v(e,"class","text-muted svelte-1ikto2t")},m(a,r){A(a,e,r),w(e,n),w(e,l),w(l,i)},p(a,r){r&4&&o!==(o=(a[2].d.home+a[2].d.within).toLocaleString()+"")&&ne(i,o)},d(a){a&&p(e)}}}function $t(t){let e,n,l,o=t[2].d.workday.toLocaleString()+"",i;return{c(){e=M("div"),n=q("Working here "),l=M("strong"),i=q(o),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=T(e);n=F(r,"Working here "),l=P(r,"STRONG",{class:!0});var s=T(l);i=F(s,o),s.forEach(p),r.forEach(p),this.h()},h(){v(l,"class","text-big svelte-1ikto2t"),v(e,"class","svelte-1ikto2t")},m(a,r){A(a,e,r),w(e,n),w(e,l),w(l,i)},p(a,r){r&4&&o!==(o=a[2].d.workday.toLocaleString()+"")&&ne(i,o)},d(a){a&&p(e)}}}function Fe(t){let e,n,l,o=(t[2].d.resident-t[2].d.home-t[2].d.within).toLocaleString()+"",i;return{c(){e=M("div"),n=q("Travelling to another area "),l=M("strong"),i=q(o),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=T(e);n=F(r,"Travelling to another area "),l=P(r,"STRONG",{});var s=T(l);i=F(s,o),s.forEach(p),r.forEach(p),this.h()},h(){v(e,"class","text-muted text-right svelte-1ikto2t")},m(a,r){A(a,e,r),w(e,n),w(e,l),w(l,i)},p(a,r){r&4&&o!==(o=(a[2].d.resident-a[2].d.home-a[2].d.within).toLocaleString()+"")&&ne(i,o)},d(a){a&&p(e)}}}function xt(t){let e,n,l,o;n=new Vt({props:{id:"select",mode:"search",options:t[0].arealist,idKey:"areacd",labelKey:"areanm",placeholder:"Find an area...",autoClear:!0}}),n.$on("change",t[6]);let i=t[2]&&We(t);return{c(){e=M("div"),U(n.$$.fragment),l=K(),i&&i.c(),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=T(e);Q(n.$$.fragment,r),l=H(r),i&&i.l(r),r.forEach(p),this.h()},h(){v(e,"class","info-palette svelte-1ikto2t")},m(a,r){A(a,e,r),Y(n,e,null),w(e,l),i&&i.m(e,null),o=!0},p(a,[r]){const s={};r&1&&(s.options=a[0].arealist),n.$set(s),a[2]?i?(i.p(a,r),r&4&&D(i,1)):(i=We(a),i.c(),D(i,1),i.m(e,null)):i&&(ge(),j(i,1,1,()=>{i=null}),ce())},i(a){o||(D(n.$$.fragment,a),D(i),o=!0)},o(a){j(n.$$.fragment,a),j(i),o=!1},d(a){a&&p(e),$(n),i&&i.d()}}}function el(t,e,n){let l;const o=ct();let{data:i}=e,{selected:a}=e,{hovered:r}=e,{highlight:s}=e;function d(c){_t.call(this,t,c)}const f=()=>o("clear");return t.$$set=c=>{"data"in c&&n(0,i=c.data),"selected"in c&&n(4,a=c.selected),"hovered"in c&&n(5,r=c.hovered),"highlight"in c&&n(1,s=c.highlight)},t.$$.update=()=>{t.$$.dirty&51&&n(2,l=(!s||!a)&&r?{...i.metadata[r],d:i.areadata[r],state:"hovered"}:a?{...i.metadata[a],d:i.areadata[a],state:"selected"}:null)},[i,s,l,o,a,r,d,f]}class tl extends me{constructor(e){super(),ve(this,e,el,xt,_e,{data:0,selected:4,hovered:5,highlight:1})}}function Ze(t,e,n){const l=t.slice();return l[22]=e[n],l}function Xe(t,e,n){const l=t.slice();return l[22]=e[n],l}function Je(t,e,n){const l=t.slice();return l[27]=e[n],l[29]=n,l}function Ue(t,e,n){const l=t.slice();return l[27]=e[n],l}function Qe(t,e,n){const l=t.slice();return l[22]=e[n],l[29]=n,l}function Ye(t,e,n){const l=t.slice();return l[27]=e[n],l[29]=n,l}function $e(t){let e,n,l,o;return{c(){e=ee("rect"),this.h()},l(i){e=te(i,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0,class:!0}),T(e).forEach(p),this.h()},h(){v(e,"x",n=t[14](t[27])),v(e,"y",0),v(e,"width",l=t[14](t[7][t[29]+1])-t[14](t[27])),v(e,"height",100),v(e,"fill",o=t[8][t[29]]),v(e,"class","svelte-1n0fg1i")},m(i,a){A(i,e,a)},p(i,a){a[0]&128&&n!==(n=i[14](i[27]))&&v(e,"x",n),a[0]&128&&l!==(l=i[14](i[7][i[29]+1])-i[14](i[27]))&&v(e,"width",l),a[0]&256&&o!==(o=i[8][i[29]])&&v(e,"fill",o)},d(i){i&&p(e)}}}function xe(t){let e,n,l,o,i,a;function r(){return t[16](t[22])}return{c(){e=ee("rect"),this.h()},l(s){e=te(s,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0,title:!0,role:!0,class:!0}),T(e).forEach(p),this.h()},h(){v(e,"x",n=t[14](t[29]===0?t[7][0]:t[13](t[22][t[2]],t[12][t[29]-1][t[2]]))),v(e,"y",0),v(e,"width",l=t[14]((t[29]===t[12].length-1?t[7][t[7].length-1]:t[13](t[22][t[2]],t[12][t[29]+1][t[2]]))-(t[29]===0?t[7][0]:t[13](t[22][t[2]],t[12][t[29]-1][t[2]])))),v(e,"height",100),v(e,"fill","rgba(0,0,0,0)"),v(e,"title",o=`${t[29]===t[12].length-1?t[7][t[7].length-1]:t[13](t[22][t[2]],t[12][t[29]+1][t[2]])}-${t[29]===0?t[7][0]:t[13](t[22][t[2]],t[12][t[29]-1][t[2]])}`),v(e,"role","none"),v(e,"class","svelte-1n0fg1i")},m(s,d){A(s,e,d),i||(a=ue(e,"mouseenter",r),i=!0)},p(s,d){t=s,d[0]&4228&&n!==(n=t[14](t[29]===0?t[7][0]:t[13](t[22][t[2]],t[12][t[29]-1][t[2]])))&&v(e,"x",n),d[0]&4228&&l!==(l=t[14]((t[29]===t[12].length-1?t[7][t[7].length-1]:t[13](t[22][t[2]],t[12][t[29]+1][t[2]]))-(t[29]===0?t[7][0]:t[13](t[22][t[2]],t[12][t[29]-1][t[2]]))))&&v(e,"width",l),d[0]&4228&&o!==(o=`${t[29]===t[12].length-1?t[7][t[7].length-1]:t[13](t[22][t[2]],t[12][t[29]+1][t[2]])}-${t[29]===0?t[7][0]:t[13](t[22][t[2]],t[12][t[29]-1][t[2]])}`)&&v(e,"title",o)},d(s){s&&p(e),i=!1,a()}}}function et(t){let e,n,l;return{c(){e=ee("line"),this.h()},l(o){e=te(o,"line",{x1:!0,x2:!0,y1:!0,y2:!0,stroke:!0,class:!0}),T(e).forEach(p),this.h()},h(){v(e,"x1",n=t[14](t[27])),v(e,"x2",l=t[14](t[27])),v(e,"y1",0),v(e,"y2",155),v(e,"stroke","white"),v(e,"class","svelte-1n0fg1i")},m(o,i){A(o,e,i)},p(o,i){i[0]&128&&n!==(n=o[14](o[27]))&&v(e,"x1",n),i[0]&128&&l!==(l=o[14](o[27]))&&v(e,"x2",l)},d(o){o&&p(e)}}}function tt(t){let e,n=t[9](t[7][t[29]])+"",l;return{c(){e=M("div"),l=q(n),this.h()},l(o){e=P(o,"DIV",{class:!0,style:!0});var i=T(e);l=F(i,n),i.forEach(p),this.h()},h(){v(e,"class","tick svelte-1n0fg1i"),z(e,"left",t[14](t[27])+"%"),z(e,"transform","translateX("+(t[29]==0&&t[11]?"-2px":"-50%")+")")},m(o,i){A(o,e,i),w(e,l)},p(o,i){i[0]&640&&n!==(n=o[9](o[7][o[29]])+"")&&ne(l,n),i[0]&128&&z(e,"left",o[14](o[27])+"%"),i[0]&2048&&z(e,"transform","translateX("+(o[29]==0&&o[11]?"-2px":"-50%")+")")},d(o){o&&p(e)}}}function lt(t){let e,n=X(t[1].filter(t[18])),l=[];for(let o=0;o<n.length;o+=1)l[o]=nt(Xe(t,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=ie()},l(o){for(let i=0;i<l.length;i+=1)l[i].l(o);e=ie()},m(o,i){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(o,i);A(o,e,i)},p(o,i){if(i[0]&17470){n=X(o[1].filter(o[18]));let a;for(a=0;a<n.length;a+=1){const r=Xe(o,n,a);l[a]?l[a].p(r,i):(l[a]=nt(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=n.length}},d(o){o&&p(e),re(l,o)}}}function nt(t){let e,n,l,o=Math.round(t[22][t[2]]).toLocaleString()+"",i,a;return{c(){e=M("div"),n=K(),l=M("div"),i=q(o),a=q(t[10]),this.h()},l(r){e=P(r,"DIV",{class:!0,style:!0}),T(e).forEach(p),n=H(r),l=P(r,"DIV",{class:!0,style:!0});var s=T(l);i=F(s,o),a=F(s,t[10]),s.forEach(p),this.h()},h(){v(e,"class","marker svelte-1n0fg1i"),z(e,"width",t[5]+"px"),z(e,"left","calc("+t[14](t[22][t[2]])+"% - "+t[5]/2+"px)"),v(l,"class","value svelte-1n0fg1i"),z(l,"left",t[14](t[22][t[2]])+"%")},m(r,s){A(r,e,s),A(r,n,s),A(r,l,s),w(l,i),w(l,a)},p(r,s){s[0]&32&&z(e,"width",r[5]+"px"),s[0]&62&&z(e,"left","calc("+r[14](r[22][r[2]])+"% - "+r[5]/2+"px)"),s[0]&30&&o!==(o=Math.round(r[22][r[2]]).toLocaleString()+"")&&ne(i,o),s[0]&1024&&ne(a,r[10]),s[0]&30&&z(l,"left",r[14](r[22][r[2]])+"%")},d(r){r&&(p(e),p(n),p(l))}}}function it(t){let e,n=X(t[1].filter(t[19])),l=[];for(let o=0;o<n.length;o+=1)l[o]=at(Ze(t,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=ie()},l(o){for(let i=0;i<l.length;i+=1)l[i].l(o);e=ie()},m(o,i){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(o,i);A(o,e,i)},p(o,i){if(i[0]&17455){n=X(o[1].filter(o[19]));let a;for(a=0;a<n.length;a+=1){const r=Ze(o,n,a);l[a]?l[a].p(r,i):(l[a]=at(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=n.length}},d(o){o&&p(e),re(l,o)}}}function at(t){let e,n,l,o=Math.round(t[22][t[2]]).toLocaleString()+"",i,a;return{c(){e=M("div"),n=K(),l=M("div"),i=q(o),a=q(t[10]),this.h()},l(r){e=P(r,"DIV",{class:!0,style:!0}),T(e).forEach(p),n=H(r),l=P(r,"DIV",{class:!0,style:!0});var s=T(l);i=F(s,o),a=F(s,t[10]),s.forEach(p),this.h()},h(){v(e,"class","marker marker-hovered svelte-1n0fg1i"),z(e,"width",t[5]+"px"),z(e,"left","calc("+t[14](t[22][t[2]])+"% - "+t[5]/2+"px)"),v(l,"class","value svelte-1n0fg1i"),z(l,"left",t[14](t[22][t[2]])+"%")},m(r,s){A(r,e,s),A(r,n,s),A(r,l,s),w(l,i),w(l,a)},p(r,s){s[0]&32&&z(e,"width",r[5]+"px"),s[0]&47&&z(e,"left","calc("+r[14](r[22][r[2]])+"% - "+r[5]/2+"px)"),s[0]&15&&o!==(o=Math.round(r[22][r[2]]).toLocaleString()+"")&&ne(i,o),s[0]&1024&&ne(a,r[10]),s[0]&15&&z(l,"left",r[14](r[22][r[2]])+"%")},d(r){r&&(p(e),p(n),p(l))}}}function ll(t){let e,n,l,o,i,a,r,s=t[9](t[7][t[7].length-1])+"",d,f,c,m,S,g,y=X(t[7].slice(0,t[7].length-1)),E=[];for(let h=0;h<y.length;h+=1)E[h]=$e(Ye(t,y,h));let R=X(t[12]),V=[];for(let h=0;h<R.length;h+=1)V[h]=xe(Qe(t,R,h));let O=X(t[7]),b=[];for(let h=0;h<O.length;h+=1)b[h]=et(Ue(t,O,h));let L=X(t[7].slice(0,t[7].length-1)),I=[];for(let h=0;h<L.length;h+=1)I[h]=tt(Je(t,L,h));let N=typeof t[4]=="string"&&lt(t),G=typeof t[0]=="string"&&it(t);return{c(){e=M("div"),n=ee("svg");for(let h=0;h<E.length;h+=1)E[h].c();l=ee("rect");for(let h=0;h<V.length;h+=1)V[h].c();o=ie();for(let h=0;h<b.length;h+=1)b[h].c();i=K();for(let h=0;h<I.length;h+=1)I[h].c();a=K(),r=M("div"),d=q(s),f=q(t[10]),c=K(),N&&N.c(),m=K(),G&&G.c(),this.h()},l(h){e=P(h,"DIV",{class:!0,style:!0});var _=T(e);n=te(_,"svg",{viewBox:!0,preserveAspectRatio:!0,role:!0,class:!0});var u=T(n);for(let B=0;B<E.length;B+=1)E[B].l(u);l=te(u,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,class:!0}),T(l).forEach(p);for(let B=0;B<V.length;B+=1)V[B].l(u);o=ie();for(let B=0;B<b.length;B+=1)b[B].l(u);u.forEach(p),i=H(_);for(let B=0;B<I.length;B+=1)I[B].l(_);a=H(_),r=P(_,"DIV",{class:!0,style:!0});var C=T(r);d=F(C,s),f=F(C,t[10]),C.forEach(p),c=H(_),N&&N.l(_),m=H(_),G&&G.l(_),_.forEach(p),this.h()},h(){v(l,"x",0),v(l,"y",0),v(l,"width",100),v(l,"height",100),v(l,"fill","none"),v(l,"stroke","#999"),v(l,"class","svelte-1n0fg1i"),v(n,"viewBox","0 0 100 100"),v(n,"preserveAspectRatio","none"),v(n,"role","none"),v(n,"class","svelte-1n0fg1i"),v(r,"class","tick svelte-1n0fg1i"),z(r,"right","0"),z(r,"transform","translateX("+(t[11]?"2px":"50%")+")"),v(e,"class","container svelte-1n0fg1i"),z(e,"height",t[6]+"px")},m(h,_){A(h,e,_),w(e,n);for(let u=0;u<E.length;u+=1)E[u]&&E[u].m(n,null);w(n,l);for(let u=0;u<V.length;u+=1)V[u]&&V[u].m(n,null);w(n,o);for(let u=0;u<b.length;u+=1)b[u]&&b[u].m(n,null);w(e,i);for(let u=0;u<I.length;u+=1)I[u]&&I[u].m(e,null);w(e,a),w(e,r),w(r,d),w(r,f),w(e,c),N&&N.m(e,null),w(e,m),G&&G.m(e,null),S||(g=ue(n,"mouseleave",t[17]),S=!0)},p(h,_){if(_[0]&16768){y=X(h[7].slice(0,h[7].length-1));let u;for(u=0;u<y.length;u+=1){const C=Ye(h,y,u);E[u]?E[u].p(C,_):(E[u]=$e(C),E[u].c(),E[u].m(n,l))}for(;u<E.length;u+=1)E[u].d(1);E.length=y.length}if(_[0]&61580){R=X(h[12]);let u;for(u=0;u<R.length;u+=1){const C=Qe(h,R,u);V[u]?V[u].p(C,_):(V[u]=xe(C),V[u].c(),V[u].m(n,o))}for(;u<V.length;u+=1)V[u].d(1);V.length=R.length}if(_[0]&16512){O=X(h[7]);let u;for(u=0;u<O.length;u+=1){const C=Ue(h,O,u);b[u]?b[u].p(C,_):(b[u]=et(C),b[u].c(),b[u].m(n,null))}for(;u<b.length;u+=1)b[u].d(1);b.length=O.length}if(_[0]&19072){L=X(h[7].slice(0,h[7].length-1));let u;for(u=0;u<L.length;u+=1){const C=Je(h,L,u);I[u]?I[u].p(C,_):(I[u]=tt(C),I[u].c(),I[u].m(e,a))}for(;u<I.length;u+=1)I[u].d(1);I.length=L.length}_[0]&640&&s!==(s=h[9](h[7][h[7].length-1])+"")&&ne(d,s),_[0]&1024&&ne(f,h[10]),_[0]&2048&&z(r,"transform","translateX("+(h[11]?"2px":"50%")+")"),typeof h[4]=="string"?N?N.p(h,_):(N=lt(h),N.c(),N.m(e,m)):N&&(N.d(1),N=null),typeof h[0]=="string"?G?G.p(h,_):(G=it(h),G.c(),G.m(e,null)):G&&(G.d(1),G=null),_[0]&64&&z(e,"height",h[6]+"px")},i:he,o:he,d(h){h&&p(e),re(E,h),re(V,h),re(b,h),re(I,h),N&&N.d(),G&&G.d(),S=!1,g()}}}function nl(t,e,n){let l;const o=ct();let{data:i}=e,{valueKey:a="value"}=e,{idKey:r="id"}=e,{hovered:s=null}=e,{selected:d=null}=e,{lineWidth:f=3}=e,{height:c=20}=e,{breaks:m=[0,10,25,50,75,100]}=e,{colors:S=["rgba(255,255,255,0.0)","rgba(255,255,255,0.1)","rgba(255,255,255,0.2)","rgba(255,255,255,0.3)","rgba(255,255,255,0.4)"]}=e,{formatTick:g=h=>Math.round(h).toLocaleString()}=e,{suffix:y=""}=e,{snapTicks:E=!0}=e;const R=(h,_)=>{const u=[...h].sort((Z,se)=>Z[_]-se[_]),C=u.map(Z=>Z[_]),B=[];for(let Z=0;Z<u.length-1;Z++)C.indexOf(u[Z][_])===Z&&B.push(u[Z]);return B},V=(h,_)=>(h+_)/2,O=h=>100*((h-m[0])/(m[m.length-1]-m[0])),b=h=>{n(0,s=h),o("hover",{id:h})},L=h=>b(h[r]),I=()=>b(null),N=h=>h[r]===d,G=h=>h[r]===s;return t.$$set=h=>{"data"in h&&n(1,i=h.data),"valueKey"in h&&n(2,a=h.valueKey),"idKey"in h&&n(3,r=h.idKey),"hovered"in h&&n(0,s=h.hovered),"selected"in h&&n(4,d=h.selected),"lineWidth"in h&&n(5,f=h.lineWidth),"height"in h&&n(6,c=h.height),"breaks"in h&&n(7,m=h.breaks),"colors"in h&&n(8,S=h.colors),"formatTick"in h&&n(9,g=h.formatTick),"suffix"in h&&n(10,y=h.suffix),"snapTicks"in h&&n(11,E=h.snapTicks)},t.$$.update=()=>{t.$$.dirty[0]&6&&n(12,l=R(i,a))},[s,i,a,r,d,f,c,m,S,g,y,E,l,V,O,b,L,I,N,G]}class il extends me{constructor(e){super(),ve(this,e,nl,ll,_e,{data:1,valueKey:2,idKey:3,hovered:0,selected:4,lineWidth:5,height:6,breaks:7,colors:8,formatTick:9,suffix:10,snapTicks:11},null,[-1,-1])}}function ot(t){let e,n,l,o;function i(r){t[5](r)}let a={data:t[1][t[2]],breaks:t[1][`${t[2]}Breaks`],idKey:"code"};return t[0]!==void 0&&(a.hovered=t[0]),n=new il({props:a}),Le.push(()=>Te(n,"hovered",i)),n.$on("hover",t[6]),{c(){e=M("div"),U(n.$$.fragment),this.h()},l(r){e=P(r,"DIV",{class:!0});var s=T(e);Q(n.$$.fragment,s),s.forEach(p),this.h()},h(){v(e,"class","breaks-palette svelte-1173c3d")},m(r,s){A(r,e,s),Y(n,e,null),o=!0},p(r,s){const d={};s&6&&(d.data=r[1][r[2]]),s&6&&(d.breaks=r[1][`${r[2]}Breaks`]),!l&&s&1&&(l=!0,d.hovered=r[0],Ce(()=>l=!1)),n.$set(d)},i(r){o||(D(n.$$.fragment,r),o=!0)},o(r){j(n.$$.fragment,r),o=!1},d(r){r&&p(e),$(n)}}}function al(t){let e,n,l=t[1]&&ot(t);return{c(){l&&l.c(),e=ie()},l(o){l&&l.l(o),e=ie()},m(o,i){l&&l.m(o,i),A(o,e,i),n=!0},p(o,[i]){o[1]?l?(l.p(o,i),i&2&&D(l,1)):(l=ot(o),l.c(),D(l,1),l.m(e.parentNode,e)):l&&(ge(),j(l,1,1,()=>{l=null}),ce())},i(o){n||(D(l),n=!0)},o(o){j(l),n=!1},d(o){o&&p(e),l&&l.d(o)}}}function ol(t,e,n){let{data:l}=e,{journeys:o}=e,{selected:i}=e,{hovered:a}=e,{highlight:r}=e;function s(f){a=f,n(0,a)}function d(f){_t.call(this,t,f)}return t.$$set=f=>{"data"in f&&n(3,l=f.data),"journeys"in f&&n(1,o=f.journeys),"selected"in f&&n(4,i=f.selected),"hovered"in f&&n(0,a=f.hovered),"highlight"in f&&n(2,r=f.highlight)},[a,o,r,l,i,s,d]}class rl extends me{constructor(e){super(),ve(this,e,ol,al,_e,{data:3,journeys:1,selected:4,hovered:0,highlight:2})}}function rt(t,e,n){const l=t.slice();return l[46]=e[n],l}function st(t){let e,n;return e=new tl({props:{data:t[5],selected:t[1],hovered:t[2],highlight:t[7]}}),e.$on("change",t[14]),e.$on("clear",t[15]),{c(){U(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,o){Y(e,l,o),n=!0},p(l,o){const i={};o[0]&32&&(i.data=l[5]),o[0]&2&&(i.selected=l[1]),o[0]&4&&(i.hovered=l[2]),o[0]&128&&(i.highlight=l[7]),e.$set(i)},i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){j(e.$$.fragment,l),n=!1},d(l){$(e,l)}}}function ft(t){let e,n,l;function o(a){t[22](a)}let i={data:t[5],journeys:t[3],selected:t[1],highlight:t[7]};return t[2]!==void 0&&(i.hovered=t[2]),e=new rl({props:i}),Le.push(()=>Te(e,"hovered",o)),e.$on("hover",t[16]),{c(){U(e.$$.fragment)},l(a){Q(e.$$.fragment,a)},m(a,r){Y(e,a,r),l=!0},p(a,r){const s={};r[0]&32&&(s.data=a[5]),r[0]&8&&(s.journeys=a[3]),r[0]&2&&(s.selected=a[1]),r[0]&128&&(s.highlight=a[7]),!n&&r[0]&4&&(n=!0,s.hovered=a[2],Ce(()=>n=!1)),e.$set(s)},i(a){l||(D(e.$$.fragment,a),l=!0)},o(a){j(e.$$.fragment,a),l=!1},d(a){$(e,a)}}}function sl(t){let e,n;return e=new de({props:{id:"quads",type:"circle",paint:{"circle-radius":1,"circle-color":"rgba(0,0,0,1)"}}}),{c(){U(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,o){Y(e,l,o),n=!0},p:he,i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){j(e.$$.fragment,l),n=!1},d(l){$(e,l)}}}function ht(t){let e,n,l,o,i,a=X(t[11]),r=[];for(let d=0;d<a.length;d+=1)r[d]=ut(rt(t,a,d));const s=d=>j(r[d],1,1,()=>{r[d]=null});return n=new Se({props:{id:"overlay-lines",type:"geojson",data:t[12].lines,$$slots:{default:[hl]},$$scope:{ctx:t}}}),o=new Se({props:{id:"overlay-points",type:"geojson",data:t[12].points,$$slots:{default:[ul]},$$scope:{ctx:t}}}),{c(){for(let d=0;d<r.length;d+=1)r[d].c();e=K(),U(n.$$.fragment),l=K(),U(o.$$.fragment)},l(d){for(let f=0;f<r.length;f+=1)r[f].l(d);e=H(d),Q(n.$$.fragment,d),l=H(d),Q(o.$$.fragment,d)},m(d,f){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(d,f);A(d,e,f),Y(n,d,f),A(d,l,f),Y(o,d,f),i=!0},p(d,f){if(f[0]&84190){a=X(d[11]);let S;for(S=0;S<a.length;S+=1){const g=rt(d,a,S);r[S]?(r[S].p(g,f),D(r[S],1)):(r[S]=ut(g),r[S].c(),D(r[S],1),r[S].m(e.parentNode,e))}for(ge(),S=a.length;S<r.length;S+=1)s(S);ce()}const c={};f[0]&4096&&(c.data=d[12].lines),f[0]&33554432&&(c.$$scope={dirty:f,ctx:d}),n.$set(c);const m={};f[0]&4096&&(m.data=d[12].points),f[0]&33554432&&(m.$$scope={dirty:f,ctx:d}),o.$set(m)},i(d){if(!i){for(let f=0;f<a.length;f+=1)D(r[f]);D(n.$$.fragment,d),D(o.$$.fragment,d),i=!0}},o(d){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)j(r[f]);j(n.$$.fragment,d),j(o.$$.fragment,d),i=!1},d(d){d&&(p(e),p(l)),re(r,d),$(n,d),$(o,d)}}}function fl(t){let e,n,l,o,i,a,r;function s(f){t[23](f)}let d={id:t[46].key+"-fill",type:"fill",data:t[3]&&t[7]?t[3][t[7]]:[],idKey:"code",paint:{"fill-color":["case",["!=",["feature-state","color"],null],["feature-state","color"],"rgba(0, 0, 0, 0)"],"fill-opacity":.7},order:"place_suburb",hover:!0,select:!0,selected:t[1],highlight:!0,highlighted:t[6],visible:t[4]===t[46].key};return t[2]!==void 0&&(d.hovered=t[2]),e=new de({props:d}),Le.push(()=>Te(e,"hovered",s)),e.$on("hover",t[16]),e.$on("select",t[14]),o=new de({props:{id:t[46].key+"-line",type:"line",paint:t[4]===t[46].key?{"line-color":"#555","line-width":.5}:{"line-color":"#777","line-width":.75},order:"place_other",visible:t[46].key==="lad"||t[4]===t[46].key}}),a=new de({props:{id:t[46].key+"-selected",type:"line",paint:{"line-color":["case",["==",["feature-state","selected"],!0],"white",["==",["feature-state","hovered"],!0],"white","rgba(0,0,0,0)"],"line-width":["case",["==",["feature-state","selected"],!0],2.5,1]},order:"place_other",visible:t[4]===t[46].key}}),{c(){U(e.$$.fragment),l=K(),U(o.$$.fragment),i=K(),U(a.$$.fragment)},l(f){Q(e.$$.fragment,f),l=H(f),Q(o.$$.fragment,f),i=H(f),Q(a.$$.fragment,f)},m(f,c){Y(e,f,c),A(f,l,c),Y(o,f,c),A(f,i,c),Y(a,f,c),r=!0},p(f,c){const m={};c[0]&2048&&(m.id=f[46].key+"-fill"),c[0]&136&&(m.data=f[3]&&f[7]?f[3][f[7]]:[]),c[0]&2&&(m.selected=f[1]),c[0]&64&&(m.highlighted=f[6]),c[0]&2064&&(m.visible=f[4]===f[46].key),!n&&c[0]&4&&(n=!0,m.hovered=f[2],Ce(()=>n=!1)),e.$set(m);const S={};c[0]&2048&&(S.id=f[46].key+"-line"),c[0]&2064&&(S.paint=f[4]===f[46].key?{"line-color":"#555","line-width":.5}:{"line-color":"#777","line-width":.75}),c[0]&2064&&(S.visible=f[46].key==="lad"||f[4]===f[46].key),o.$set(S);const g={};c[0]&2048&&(g.id=f[46].key+"-selected"),c[0]&2064&&(g.visible=f[4]===f[46].key),a.$set(g)},i(f){r||(D(e.$$.fragment,f),D(o.$$.fragment,f),D(a.$$.fragment,f),r=!0)},o(f){j(e.$$.fragment,f),j(o.$$.fragment,f),j(a.$$.fragment,f),r=!1},d(f){f&&(p(l),p(i)),$(e,f),$(o,f),$(a,f)}}}function ut(t){let e,n;const l=[{id:t[46].key},{type:t[46].type},{promoteId:"areacd"},t[46].props];let o={$$slots:{default:[fl]},$$scope:{ctx:t}};for(let i=0;i<l.length;i+=1)o=Ot(o,l[i]);return e=new Se({props:o}),{c(){U(e.$$.fragment)},l(i){Q(e.$$.fragment,i)},m(i,a){Y(e,i,a),n=!0},p(i,a){const r=a[0]&2048?Mt(l,[{id:i[46].key},{type:i[46].type},l[2],Pt(i[46].props)]):{};a[0]&33556702&&(r.$$scope={dirty:a,ctx:i}),e.$set(r)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){j(e.$$.fragment,i),n=!1},d(i){$(e,i)}}}function hl(t){let e,n;return e=new de({props:{id:"overlay-lines",type:"line",paint:{"line-color":"white","line-width":1},order:"place_other"}}),{c(){U(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,o){Y(e,l,o),n=!0},p:he,i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){j(e.$$.fragment,l),n=!1},d(l){$(e,l)}}}function ul(t){let e,n;return e=new de({props:{id:"overlay-points",type:"circle",paint:{"circle-color":"white","circle-radius":3},order:"place_other"}}),{c(){U(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,o){Y(e,l,o),n=!0},p:he,i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){j(e.$$.fragment,l),n=!1},d(l){$(e,l)}}}function dl(t){let e,n,l,o;e=new Se({props:{id:"quads",type:"geojson",data:t[5].quads,$$slots:{default:[sl]},$$scope:{ctx:t}}});let i=t[11][1].props.data&&ht(t);return{c(){U(e.$$.fragment),n=K(),i&&i.c(),l=ie()},l(a){Q(e.$$.fragment,a),n=H(a),i&&i.l(a),l=ie()},m(a,r){Y(e,a,r),A(a,n,r),i&&i.m(a,r),A(a,l,r),o=!0},p(a,r){const s={};r[0]&32&&(s.data=a[5].quads),r[0]&33554432&&(s.$$scope={dirty:r,ctx:a}),e.$set(s),a[11][1].props.data?i?(i.p(a,r),r[0]&2048&&D(i,1)):(i=ht(a),i.c(),D(i,1),i.m(l.parentNode,l)):i&&(ge(),j(i,1,1,()=>{i=null}),ce())},i(a){o||(D(e.$$.fragment,a),D(i),o=!0)},o(a){j(e.$$.fragment,a),j(i),o=!1},d(a){a&&(p(n),p(l)),$(e,a),i&&i.d(a)}}}function gl(t){let e,n,l,o,i,a,r;const s=t[21].default,d=Ct(s,t,t[25],null);let f=t[9]&&st(t),c=t[10]&&t[7]&&ft(t);function m(g){t[24](g)}let S={style:jt+"/data/style.json",location:{bounds:zt.ew},options:{antialias:!0},interactive:t[8],controls:t[8],$$slots:{default:[dl]},$$scope:{ctx:t}};return t[0]!==void 0&&(S.map=t[0]),i=new Gt({props:S}),Le.push(()=>Te(i,"map",m)),i.$on("load",t[13]),{c(){e=M("div"),d&&d.c(),n=K(),f&&f.c(),l=K(),c&&c.c(),o=K(),U(i.$$.fragment),this.h()},l(g){e=P(g,"DIV",{class:!0});var y=T(e);d&&d.l(y),n=H(y),f&&f.l(y),l=H(y),c&&c.l(y),o=H(y),Q(i.$$.fragment,y),y.forEach(p),this.h()},h(){v(e,"class","map svelte-1hr1a2")},m(g,y){A(g,e,y),d&&d.m(e,null),w(e,n),f&&f.m(e,null),w(e,l),c&&c.m(e,null),w(e,o),Y(i,e,null),r=!0},p(g,y){d&&d.p&&(!r||y[0]&33554432)&&Tt(d,s,g,g[25],r?Bt(s,g[25],y,null):It(g[25]),null),g[9]?f?(f.p(g,y),y[0]&512&&D(f,1)):(f=st(g),f.c(),D(f,1),f.m(e,l)):f&&(ge(),j(f,1,1,()=>{f=null}),ce()),g[10]&&g[7]?c?(c.p(g,y),y[0]&1152&&D(c,1)):(c=ft(g),c.c(),D(c,1),c.m(e,o)):c&&(ge(),j(c,1,1,()=>{c=null}),ce());const E={};y[0]&256&&(E.interactive=g[8]),y[0]&256&&(E.controls=g[8]),y[0]&33560830&&(E.$$scope={dirty:y,ctx:g}),!a&&y[0]&1&&(a=!0,E.map=g[0],Ce(()=>a=!1)),i.$set(E)},i(g){r||(D(d,g),D(f),D(c),D(i.$$.fragment,g),r=!0)},o(g){j(d,g),j(f),j(c),j(i.$$.fragment,g),r=!1},d(g){g&&p(e),d&&d.d(g),f&&f.d(),c&&c.d(),$(i)}}}function cl(t,e,n){let{$$slots:l={},$$scope:o}=e;const i=Wt([5,14],[.5,4]),a={work:[39,160,204],migration:[246,96,104]};let{data:r}=e,{map:s=null}=e,{selected:d}=e,{hovered:f}=e,{highlighted:c}=e,{journeys:m}=e,{geo:S="lad"}=e,{pos:g="from"}=e,{highlight:y=null}=e,{filter:E=!0}=e,{color:R=a.work}=e,{pixelRatio:V=1}=e,{interactive:O=!0}=e,{showInfo:b=!0}=e,{showBreaks:L=!0}=e,I,N,G,h,_,u,C,B,Z,se,fe,ae=Re();function pe(){n(11,I=r.sources),N=r.points,G=N.array.length;const k=W=>(u=At(W),C=Dt(u),Z=C.buffer(N[g],{duration:5e3,ease:"linear"}),se=u.buffer(Array.from({length:G},()=>.7)),{render:C({vert:`
      precision lowp float;
      uniform mat4 uMatrix;
      uniform float pointSize;
      uniform vec3 pointColor;
      attribute vec2 position;
			attribute float opacity;
			varying vec4 fragColor;

      void main() {
        gl_PointSize = pointSize;
        gl_Position = uMatrix * vec4(position, 0, 1);
        fragColor = vec4(pointColor, opacity);
      }
        `,frag:`
      precision lowp float;
			varying vec4 fragColor;

      void main() {
        if (length(gl_PointCoord.xy - 0.5) > 0.5) {
          discard;
        }
        gl_FragColor = fragColor;
      }
      `,attributes:{position:Z,opacity:se},uniforms:{pointSize:u.prop("pointSize")||2,pointColor:u.prop("pointColor"),uMatrix:u.prop("uMatrix")},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},depth:{enable:!1},count:G,primitive:"points"})});n(17,V=window.devicePixelRatio>1.5?1.5:window.devicePixelRatio),s.setPixelRatio(V),s.addLayer({id:"custom_layer",type:"custom",onAdd:(W,J)=>{B=k(J),u.frame(()=>{W&&h&&W.triggerRepaint()})},render(W,J){fe=J,h=s.getZoom(),B.render({uMatrix:fe,pointSize:i(h)*V,pointColor:R.map(oe=>oe/255)})}},"place_suburb"),s.on("moveend",()=>{d||Ae()}),_=new Kt.Popup({closeButton:!1,closeOnClick:!1})}let Ge=y;function Ie(k=Ge){d&&(se({data:E?N.array.map(W=>!k||W[`${k==="to"?"from":"to"}_${S}`]===d?1:.01):Array.from({length:N.array.length},()=>.7)}),Ge=k)}let Me=O;function mt(k){const W=["boxZoom","doubleClickZoom","dragPan","dragRotate","keyboard","scrollZoom","touchPitch","touchZoomRotate"];if(Me!==k){for(const J of W)s&&k?s[J].enable():s&&s[J].disable();Me=k}}let Pe=g;function vt(k,W=5e3){Pe!==k&&(Z.update(N[k],W?{duration:W}:null),Pe=k)}function pt(k){const W=k.from.slice(0,k.from.map(x=>x.color).indexOf("rgba(255,255,255,0.1)")),J=k.to.slice(0,k.from.map(x=>x.color).indexOf("rgba(255,255,255,0.1)"));return Array.from(new Set([...W.map(x=>x.code),...J.map(x=>x.code)])).map(x=>{const le=r.metadata[x];return[le.xmin,le.ymin,le.xmax,le.ymax]}).reduce((x,le)=>[Math.min(x[0],le[0]),Math.min(x[1],le[1]),Math.max(x[2],le[2]),Math.max(x[3],le[3])])}async function kt(k){var J,oe;const W=typeof k=="string"?k:((J=k==null?void 0:k.detail)==null?void 0:J.id)||((oe=k==null?void 0:k.detail)==null?void 0:oe.areacd);if(console.debug("select",k,W),W){n(3,m=await Ht(W)),n(1,d=W),n(4,S=["E02","W02"].includes(W.slice(0,3))?"msoa":"lad"),Ie();const ke=pt(m);s.fitBounds(ke,{padding:20})}}async function bt(){n(1,d=null),n(3,m=null),Ie(),Ae()}function wt(k){var J,oe,ke,x;const W=typeof k=="string"?k:((J=k==null?void 0:k.detail)==null?void 0:J.id)||((oe=k==null?void 0:k.detail)==null?void 0:oe.areacd);if(n(12,ae=d&&y?Re((ke=r.metadata)==null?void 0:ke[d],(x=r.metadata)==null?void 0:x[W]):Re()),console.log(ae.points),ae.midpoint){const le=r.metadata[d].areanm,Be=r.metadata[f].areanm;let Oe;if(Be===le){const be=r.areadata[d];Oe=`<b>Within ${le}</b><br/>${be.within.toLocaleString()} internal trips<br/>${be.home.toLocaleString()} work from home`}else{const be=y==="to"?m.toLookup[f]||0:m.fromLookup[f]||0;Oe=`<b>${y==="to"?`${le} &rarr; ${Be}`:`${Be} &rarr; ${le}`}</b><br/>${be.toLocaleString()} trips`}_.setLngLat(ae.midpoint).setHTML(Oe).addTo(s)}else _.remove()}function Ae(){const k=s==null?void 0:s.queryRenderedFeatures({layers:["quads"]});if(Array.isArray(k)){const W=k.length,J=s.getCanvas(),oe=J.clientWidth*J.clientHeight;n(4,S=W*1e6/oe>40?"lad":"msoa")}}function yt(k){f=k,n(2,f)}function Et(k){f=k,n(2,f)}function St(k){s=k,n(0,s)}return t.$$set=k=>{"data"in k&&n(5,r=k.data),"map"in k&&n(0,s=k.map),"selected"in k&&n(1,d=k.selected),"hovered"in k&&n(2,f=k.hovered),"highlighted"in k&&n(6,c=k.highlighted),"journeys"in k&&n(3,m=k.journeys),"geo"in k&&n(4,S=k.geo),"pos"in k&&n(18,g=k.pos),"highlight"in k&&n(7,y=k.highlight),"filter"in k&&n(19,E=k.filter),"color"in k&&n(20,R=k.color),"pixelRatio"in k&&n(17,V=k.pixelRatio),"interactive"in k&&n(8,O=k.interactive),"showInfo"in k&&n(9,b=k.showInfo),"showBreaks"in k&&n(10,L=k.showBreaks),"$$scope"in k&&n(25,o=k.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&128&&Ie(y),t.$$.dirty[0]&256&&mt(O),t.$$.dirty[0]&262144&&vt(g)},[s,d,f,m,S,r,c,y,O,b,L,I,ae,pe,kt,bt,wt,V,g,E,R,l,yt,Et,St,o]}class _l extends me{constructor(e){super(),ve(this,e,cl,gl,_e,{data:5,map:0,selected:1,hovered:2,highlighted:6,journeys:3,geo:4,pos:18,highlight:7,filter:19,color:20,pixelRatio:17,interactive:8,showInfo:9,showBreaks:10},null,[-1,-1])}}function dt(t,e,n){const l=t.slice();return l[10]=e[n],l}function gt(t){let e,n=t[10]==="from"?"origin":"destination",l;return{c(){e=M("option"),l=q(n),this.h()},l(o){e=P(o,"OPTION",{});var i=T(e);l=F(i,n),i.forEach(p),this.h()},h(){e.__value=t[10],Ee(e,e.__value)},m(o,i){A(o,e,i),w(e,l)},p:he,d(o){o&&p(e)}}}function ml(t){let e,n,l,o,i,a,r,s,d,f,c,m,S,g,y,E,R,V="working here",O,b="living here",L,I="none",N,G,h=X(t[4]),_=[];for(let u=0;u<h.length;u+=1)_[u]=gt(dt(t,h,u));return{c(){e=M("div"),n=M("label"),l=M("input"),o=q(`
        Interactive`),i=K(),a=M("label"),r=q("Point location"),s=M("br"),d=K(),f=M("select");for(let u=0;u<_.length;u+=1)_[u].c();c=K(),m=M("label"),S=q("Highlight"),g=M("br"),y=K(),E=M("select"),R=M("option"),R.textContent=V,O=M("option"),O.textContent=b,L=M("option"),L.textContent=I,this.h()},l(u){e=P(u,"DIV",{class:!0});var C=T(e);n=P(C,"LABEL",{class:!0});var B=T(n);l=P(B,"INPUT",{type:!0}),o=F(B,`
        Interactive`),B.forEach(p),i=H(C),a=P(C,"LABEL",{class:!0});var Z=T(a);r=F(Z,"Point location"),s=P(Z,"BR",{}),d=H(Z),f=P(Z,"SELECT",{});var se=T(f);for(let pe=0;pe<_.length;pe+=1)_[pe].l(se);se.forEach(p),Z.forEach(p),c=H(C),m=P(C,"LABEL",{class:!0});var fe=T(m);S=F(fe,"Highlight"),g=P(fe,"BR",{}),y=H(fe),E=P(fe,"SELECT",{});var ae=T(E);R=P(ae,"OPTION",{"data-svelte-h":!0}),ye(R)!=="svelte-1hla8p7"&&(R.textContent=V),O=P(ae,"OPTION",{"data-svelte-h":!0}),ye(O)!=="svelte-1k66d52"&&(O.textContent=b),L=P(ae,"OPTION",{"data-svelte-h":!0}),ye(L)!=="svelte-1jd81zj"&&(L.textContent=I),ae.forEach(p),fe.forEach(p),C.forEach(p),this.h()},h(){v(l,"type","checkbox"),v(n,"class","svelte-1u46gza"),t[2]===void 0&&Ve(()=>t[7].call(f)),v(a,"class","svelte-1u46gza"),R.__value="from",Ee(R,R.__value),O.__value="to",Ee(O,O.__value),L.__value=null,Ee(L,L.__value),t[3]===void 0&&Ve(()=>t[8].call(E)),v(m,"class","svelte-1u46gza"),v(e,"class","toggles svelte-1u46gza")},m(u,C){A(u,e,C),w(e,n),w(n,l),l.checked=t[1],w(n,o),w(e,i),w(e,a),w(a,r),w(a,s),w(a,d),w(a,f);for(let B=0;B<_.length;B+=1)_[B]&&_[B].m(f,null);we(f,t[2],!0),w(e,c),w(e,m),w(m,S),w(m,g),w(m,y),w(m,E),w(E,R),w(E,O),w(E,L),we(E,t[3],!0),N||(G=[ue(l,"change",t[6]),ue(f,"change",t[7]),ue(E,"change",t[8])],N=!0)},p(u,C){if(C&2&&(l.checked=u[1]),C&16){h=X(u[4]);let B;for(B=0;B<h.length;B+=1){const Z=dt(u,h,B);_[B]?_[B].p(Z,C):(_[B]=gt(Z),_[B].c(),_[B].m(f,null))}for(;B<_.length;B+=1)_[B].d(1);_.length=h.length}C&20&&we(f,u[2]),C&8&&we(E,u[3])},d(u){u&&p(e),re(_,u),N=!1,Rt(G)}}}function vl(t){let e,n;return e=new _l({props:{data:t[0],interactive:t[1],geo:t[5],pos:t[2],highlight:t[3],$$slots:{default:[ml]},$$scope:{ctx:t}}}),{c(){U(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,o){Y(e,l,o),n=!0},p(l,o){const i={};o&1&&(i.data=l[0]),o&2&&(i.interactive=l[1]),o&4&&(i.pos=l[2]),o&8&&(i.highlight=l[3]),o&8206&&(i.$$scope={dirty:o,ctx:l}),e.$set(i)},i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){j(e.$$.fragment,l),n=!1},d(l){$(e,l)}}}function pl(t){let e,n;return e=new Nt({props:{theme:"dark",$$slots:{default:[vl]},$$scope:{ctx:t}}}),{c(){U(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,o){Y(e,l,o),n=!0},p(l,[o]){const i={};o&8207&&(i.$$scope={dirty:o,ctx:l}),e.$set(i)},i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){j(e.$$.fragment,l),n=!1},d(l){$(e,l)}}}function kl(t,e,n){let{data:l}=e;const o=["lad","msoa"],i=["from","to"];let a=!0,r=o[0],s=i[0],d=null;function f(){a=this.checked,n(1,a)}function c(){s=De(this),n(2,s),n(4,i)}function m(){d=De(this),n(3,d)}return t.$$set=S=>{"data"in S&&n(0,l=S.data)},[l,a,s,d,i,r,f,c,m]}class Tl extends me{constructor(e){super(),ve(this,e,kl,pl,_e,{data:0})}}export{Tl as component,Cl as universal};
