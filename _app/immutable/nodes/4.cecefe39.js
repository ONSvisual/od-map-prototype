//js
import{s as Ie,e as ge,i as N,y as be,d as v,o as El,O as se,P as fe,h as G,j as d,k as x,x as k,A as ue,f as A,a as F,g as O,c as X,R as yl,l as Y,m as $,n as de,E as Le,S as Sl,p as Me,F as Pe,r as Ll,u as Bl,v as Il,w as Tl,H as Gl,T as Oe,I as De,U as Se,G as Rl,V as Ne}from"../chunks/scheduler.0a5fefc6.js";import{S as Te,i as Ge,b as ie,d as ae,m as oe,a as D,g as ye,c as Ee,t as Z,e as re,f as Ae}from"../chunks/index.31724489.js";import{e as J,M as Cl,b as Ve,g as Ml,c as Pl,d as Be,r as Al,a as Ol}from"../chunks/MapTooltip.svelte_svelte_type_style_lang.4be9a860.js";import{a as Dl,T as Vl}from"../chunks/Table.svelte_svelte_type_style_lang.8b7fe08b.js";import{b as Nl}from"../chunks/paths.2ad60fe0.js";import{b as jl,e as ze,d as zl,s as Kl}from"../chunks/utils.cc42e28e.js";const pt=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));function Ke(e,l,n){const t=e.slice();return t[11]=l[n],t}function Ze(e,l,n){const t=e.slice();return t[14]=l[n],t[16]=n,t}function He(e){let l,n,t,i,o,a,r=`${e[0]}px`,s=J(e[1]),f=[];for(let h=0;h<s.length;h+=1)f[h]=We(Ze(e,s,h));let _=J(e[4]),m=[];for(let h=0;h<_.length;h+=1)m[h]=Fe(Ke(e,_,h));return{c(){l=se("svg"),n=se("defs"),t=se("linearGradient"),i=se("stop"),o=se("linearGradient"),a=se("stop");for(let h=0;h<f.length;h+=1)f[h].c();for(let h=0;h<m.length;h+=1)m[h].c();this.h()},l(h){l=fe(h,"svg",{viewBox:!0,preserveAspectRatio:!0,class:!0});var b=G(l);n=fe(b,"defs",{});var g=G(n);t=fe(g,"linearGradient",{id:!0});var y=G(t);i=fe(y,"stop",{"stop-color":!0}),G(i).forEach(v),y.forEach(v),o=fe(g,"linearGradient",{id:!0});var E=G(o);a=fe(E,"stop",{"stop-color":!0,"stop-opacity":!0}),G(a).forEach(v),E.forEach(v);for(let P=0;P<f.length;P+=1)f[P].l(g);g.forEach(v);for(let P=0;P<m.length;P+=1)m[P].l(b);b.forEach(v),this.h()},h(){d(i,"stop-color",e[3]),d(t,"id","solid"),d(a,"stop-color",e[3]),d(a,"stop-opacity","0.2"),d(o,"id","transparent"),d(l,"viewBox","0 0 100 100"),d(l,"preserveAspectRatio","none"),d(l,"class","svelte-m0a6o9"),x(l,"height",r)},m(h,b){N(h,l,b),k(l,n),k(n,t),k(t,i),k(n,o),k(o,a);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(n,null);for(let g=0;g<m.length;g+=1)m[g]&&m[g].m(l,null)},p(h,b){if(b&8&&d(i,"stop-color",h[3]),b&8&&d(a,"stop-color",h[3]),b&10){s=J(h[1]);let g;for(g=0;g<s.length;g+=1){const y=Ze(h,s,g);f[g]?f[g].p(y,b):(f[g]=We(y),f[g].c(),f[g].m(n,null))}for(;g<f.length;g+=1)f[g].d(1);f.length=s.length}if(b&54){_=J(h[4]);let g;for(g=0;g<_.length;g+=1){const y=Ke(h,_,g);m[g]?m[g].p(y,b):(m[g]=Fe(y),m[g].c(),m[g].m(l,null))}for(;g<m.length;g+=1)m[g].d(1);m.length=_.length}b&1&&r!==(r=`${h[0]}px`)&&x(l,"height",r)},d(h){h&&v(l),ue(f,h),ue(m,h)}}}function We(e){let l,n,t,i;return{c(){l=se("linearGradient"),n=se("stop"),t=se("stop"),this.h()},l(o){l=fe(o,"linearGradient",{id:!0,gradientTransform:!0});var a=G(l);n=fe(a,"stop",{offset:!0,"stop-color":!0,"stop-opacity":!0}),G(n).forEach(v),t=fe(a,"stop",{offset:!0,"stop-color":!0,"stop-opacity":!0}),G(t).forEach(v),a.forEach(v),this.h()},h(){d(n,"offset","5%"),d(n,"stop-color",e[3]),d(n,"stop-opacity",e[16]===0?1:.2),d(t,"offset","95%"),d(t,"stop-color",e[3]),d(t,"stop-opacity",e[16]===0?.2:1),d(l,"id",i=e[14]+"_gradient"),d(l,"gradientTransform","rotate(90)")},m(o,a){N(o,l,a),k(l,n),k(l,t)},p(o,a){a&8&&d(n,"stop-color",o[3]),a&8&&d(t,"stop-color",o[3]),a&2&&i!==(i=o[14]+"_gradient")&&d(l,"id",i)},d(o){o&&v(l)}}}function Fe(e){let l,n,t;function i(...o){return e[8](e[11],...o)}return{c(){l=se("path"),this.h()},l(o){l=fe(o,"path",{d:!0,fill:!0}),G(l).forEach(v),this.h()},h(){d(l,"d",n=e[5](...e[1].map(i),e[11].value)),d(l,"fill",t="url(#"+(Array.isArray(e[2])?`${e[11][e[2][0]]===e[2][1]?"solid":"transparent"}`:typeof e[2]=="string"?`${e[11][e[1][0]]===e[2]&&e[11][e[1][1]]===e[2]?"solid":e[11][e[1][0]]===e[2]?`${e[1][0]}_gradient`:e[11][e[1][1]]===e[2]?`${e[1][1]}_gradient`:"transparent"}`:"solid")+")")},m(o,a){N(o,l,a)},p(o,a){e=o,a&50&&n!==(n=e[5](...e[1].map(i),e[11].value))&&d(l,"d",n),a&22&&t!==(t="url(#"+(Array.isArray(e[2])?`${e[11][e[2][0]]===e[2][1]?"solid":"transparent"}`:typeof e[2]=="string"?`${e[11][e[1][0]]===e[2]&&e[11][e[1][1]]===e[2]?"solid":e[11][e[1][0]]===e[2]?`${e[1][0]}_gradient`:e[11][e[1][1]]===e[2]?`${e[1][1]}_gradient`:"transparent"}`:"solid")+")")&&d(l,"fill",t)},d(o){o&&v(l)}}}function Zl(e){let l,n=e[4]&&He(e);return{c(){n&&n.c(),l=ge()},l(t){n&&n.l(t),l=ge()},m(t,i){n&&n.m(t,i),N(t,l,i)},p(t,[i]){t[4]?n?n.p(t,i):(n=He(t),n.c(),n.m(l.parentNode,l)):n&&(n.d(1),n=null)},i:be,o:be,d(t){t&&v(l),n&&n.d(t)}}}const Hl=100;function Wl(e,l,n){let{data:t}=l,{height:i=80}=l,{gap:o=10}=l,{keys:a=["from","to"]}=l,{highlight:r="a"}=l,{color:s="#27a0cc"}=l,f,_;function m(g,y){const E=Hl-o*(g.length-1);return function(P){const T=g.slice(1).reduce((j,w)=>P>=w?j+o:j,0);return P*(E/y)+T}}function h(g){let y=JSON.parse(JSON.stringify(g)),E={},P={},T={},j={};for(const w of a){E[w]={};for(const I of y)E[w][I[w]]||(E[w][I[w]]={key:I[w],size:0}),E[w][I[w]].size+=I.value;let C=0;for(const I of Object.keys(E[w]).sort((z,H)=>z.localeCompare(H)))E[w][I].start=C,E[w][I].current=C,C+=E[w][I].size,T[w]=C;P[w]=Object.keys(E[w]).map(I=>E[w][I].start),j[w]=m(P[w],T[w])}for(const w of y)for(const C of a)w[`${C}_start`]=E[C][w[C]].current,E[C][w[C]].current+=w.value;n(5,_=(w,C,I)=>`
			M ${j[a[0]](w)},0
			L ${j[a[0]](w+I-.1)},0
			C ${j[a[0]](w+I-.1)},40 ${j[a[1]](C+I-.1)},40 ${j[a[1]](C+I-.1)},80
			L ${j[a[1]](C+I/2)},100
			L ${j[a[1]](C)},80
			C ${j[a[1]](C)},40 ${j[a[0]](w)},40 ${j[a[0]](w)},0 Z`),n(4,f=y)}El(()=>h(t));const b=(g,y)=>g[`${y}_start`];return e.$$set=g=>{"data"in g&&n(6,t=g.data),"height"in g&&n(0,i=g.height),"gap"in g&&n(7,o=g.gap),"keys"in g&&n(1,a=g.keys),"highlight"in g&&n(2,r=g.highlight),"color"in g&&n(3,s=g.color)},e.$$.update=()=>{e.$$.dirty&64&&h(t)},[i,a,r,s,f,_,t,o,b]}class Fl extends Te{constructor(l){super(),Ge(this,l,Wl,Zl,Ie,{data:6,height:0,gap:7,keys:1,highlight:2,color:3})}}function Xe(e,l,n){const t=e.slice();return t[4]=l[n],t}function Je(e,l,n){const t=e.slice();return t[7]=l[n],t}function Ue(e){let l,n=e[4].areanm+"",t,i,o,a,r,s,f=e[7].resident.toLocaleString()+"",_,m,h,b,g,y=(e[7].workday-e[7].home-e[7].within).toLocaleString()+"",E,P,T,j,w,C,I,z,H,u,S=e[7].workday.toLocaleString()+"",c,M,K,V,B=(e[7].workday-e[7].resident).toLocaleString("en-GB",{signDisplay:"exceptZero"})+"",W,L,q,pe,he,me=(e[7].resident-e[7].home-e[7].within).toLocaleString()+"",_e,ke,Q;return T=new Fl({props:{data:[{from:"a",to:"a",value:e[7].home+e[7].within},{from:"a",to:"b",value:e[7].resident-e[7].home-e[7].within},{from:"b",to:"a",value:e[7].workday-e[7].home-e[7].within}],highlight:e[2]==="from"?["to","a"]:e[2]==="to"?["from","a"]:"a"}}),{c(){l=A("h2"),t=Y(n),i=F(),o=A("div"),a=A("div"),r=Y("Living here "),s=A("strong"),_=Y(f),m=F(),h=A("div"),b=Y("Travelling from another area "),g=A("strong"),E=Y(y),P=F(),ie(T.$$.fragment),j=F(),w=A("div"),C=A("div"),I=Y("Working here"),z=A("br"),H=F(),u=A("strong"),c=Y(S),M=A("br"),K=F(),V=A("span"),W=Y(B),L=F(),q=A("div"),pe=Y("Travelling to another area "),he=A("strong"),_e=Y(me),ke=F(),this.h()},l(R){l=O(R,"H2",{});var ee=G(l);t=$(ee,n),ee.forEach(v),i=X(R),o=O(R,"DIV",{class:!0});var ve=G(o);a=O(ve,"DIV",{class:!0});var Re=G(a);r=$(Re,"Living here "),s=O(Re,"STRONG",{class:!0});var Ce=G(s);_=$(Ce,f),Ce.forEach(v),Re.forEach(v),m=X(ve),h=O(ve,"DIV",{class:!0});var p=G(h);b=$(p,"Travelling from another area "),g=O(p,"STRONG",{});var U=G(g);E=$(U,y),U.forEach(v),p.forEach(v),ve.forEach(v),P=X(R),ae(T.$$.fragment,R),j=X(R),w=O(R,"DIV",{class:!0});var le=G(w);C=O(le,"DIV",{class:!0});var ne=G(C);I=$(ne,"Working here"),z=O(ne,"BR",{}),H=X(ne),u=O(ne,"STRONG",{class:!0});var we=G(u);c=$(we,S),we.forEach(v),M=O(ne,"BR",{}),K=X(ne),V=O(ne,"SPAN",{class:!0});var te=G(V);W=$(te,B),te.forEach(v),ne.forEach(v),L=X(le),q=O(le,"DIV",{class:!0});var ce=G(q);pe=$(ce,"Travelling to another area "),he=O(ce,"STRONG",{});var je=G(he);_e=$(je,me),je.forEach(v),ce.forEach(v),ke=X(le),le.forEach(v),this.h()},h(){d(s,"class","text-big svelte-s1o4bk"),d(a,"class","svelte-s1o4bk"),d(h,"class","text-muted svelte-s1o4bk"),d(o,"class","info-grid svelte-s1o4bk"),d(u,"class","text-big svelte-s1o4bk"),d(V,"class","text-muted svelte-s1o4bk"),d(C,"class","svelte-s1o4bk"),d(q,"class","text-muted svelte-s1o4bk"),d(w,"class","info-grid svelte-s1o4bk")},m(R,ee){N(R,l,ee),k(l,t),N(R,i,ee),N(R,o,ee),k(o,a),k(a,r),k(a,s),k(s,_),k(o,m),k(o,h),k(h,b),k(h,g),k(g,E),N(R,P,ee),oe(T,R,ee),N(R,j,ee),N(R,w,ee),k(w,C),k(C,I),k(C,z),k(C,H),k(C,u),k(u,c),k(C,M),k(C,K),k(C,V),k(V,W),k(w,L),k(w,q),k(q,pe),k(q,he),k(he,_e),k(w,ke),Q=!0},p(R,ee){(!Q||ee&3)&&n!==(n=R[4].areanm+"")&&de(t,n),(!Q||ee&3)&&f!==(f=R[7].resident.toLocaleString()+"")&&de(_,f),(!Q||ee&3)&&y!==(y=(R[7].workday-R[7].home-R[7].within).toLocaleString()+"")&&de(E,y);const ve={};ee&3&&(ve.data=[{from:"a",to:"a",value:R[7].home+R[7].within},{from:"a",to:"b",value:R[7].resident-R[7].home-R[7].within},{from:"b",to:"a",value:R[7].workday-R[7].home-R[7].within}]),ee&4&&(ve.highlight=R[2]==="from"?["to","a"]:R[2]==="to"?["from","a"]:"a"),T.$set(ve),(!Q||ee&3)&&S!==(S=R[7].workday.toLocaleString()+"")&&de(c,S),(!Q||ee&3)&&B!==(B=(R[7].workday-R[7].resident).toLocaleString("en-GB",{signDisplay:"exceptZero"})+"")&&de(W,B),(!Q||ee&3)&&me!==(me=(R[7].resident-R[7].home-R[7].within).toLocaleString()+"")&&de(_e,me)},i(R){Q||(D(T.$$.fragment,R),Q=!0)},o(R){Z(T.$$.fragment,R),Q=!1},d(R){R&&(v(l),v(i),v(o),v(P),v(j),v(w)),re(T,R)}}}function qe(e){let l,n,t=J([e[0].areadata[e[1]]]),i=[];for(let a=0;a<1;a+=1)i[a]=Ue(Je(e,t,a));const o=a=>Z(i[a],1,1,()=>{i[a]=null});return{c(){for(let a=0;a<1;a+=1)i[a].c();l=ge()},l(a){for(let r=0;r<1;r+=1)i[r].l(a);l=ge()},m(a,r){for(let s=0;s<1;s+=1)i[s]&&i[s].m(a,r);N(a,l,r),n=!0},p(a,r){if(r&7){t=J([a[0].areadata[a[1]]]);let s;for(s=0;s<1;s+=1){const f=Je(a,t,s);i[s]?(i[s].p(f,r),D(i[s],1)):(i[s]=Ue(f),i[s].c(),D(i[s],1),i[s].m(l.parentNode,l))}for(ye(),s=1;s<1;s+=1)o(s);Ee()}},i(a){if(!n){for(let r=0;r<1;r+=1)D(i[r]);n=!0}},o(a){i=i.filter(Boolean);for(let r=0;r<1;r+=1)Z(i[r]);n=!1},d(a){a&&v(l),ue(i,a)}}}function Xl(e){let l,n,t,i;n=new Dl({props:{id:"select",mode:"search",options:e[0].arealist,idKey:"areacd",labelKey:"areanm",placeholder:"Find an area...",autoClear:!0}}),n.$on("change",e[3]);let o=J(e[1]?[e[0].metadata[e[1]]]:[]),a=[];for(let s=0;s<o.length;s+=1)a[s]=qe(Xe(e,o,s));const r=s=>Z(a[s],1,1,()=>{a[s]=null});return{c(){l=A("div"),ie(n.$$.fragment),t=F();for(let s=0;s<a.length;s+=1)a[s].c();this.h()},l(s){l=O(s,"DIV",{class:!0});var f=G(l);ae(n.$$.fragment,f),t=X(f);for(let _=0;_<a.length;_+=1)a[_].l(f);f.forEach(v),this.h()},h(){d(l,"class","info-palette svelte-s1o4bk")},m(s,f){N(s,l,f),oe(n,l,null),k(l,t);for(let _=0;_<a.length;_+=1)a[_]&&a[_].m(l,null);i=!0},p(s,[f]){const _={};if(f&1&&(_.options=s[0].arealist),n.$set(_),f&7){o=J(s[1]?[s[0].metadata[s[1]]]:[]);let m;for(m=0;m<o.length;m+=1){const h=Xe(s,o,m);a[m]?(a[m].p(h,f),D(a[m],1)):(a[m]=qe(h),a[m].c(),D(a[m],1),a[m].m(l,null))}for(ye(),m=o.length;m<a.length;m+=1)r(m);Ee()}},i(s){if(!i){D(n.$$.fragment,s);for(let f=0;f<o.length;f+=1)D(a[f]);i=!0}},o(s){Z(n.$$.fragment,s),a=a.filter(Boolean);for(let f=0;f<a.length;f+=1)Z(a[f]);i=!1},d(s){s&&v(l),re(n),ue(a,s)}}}function Jl(e,l,n){let{data:t}=l,{selected:i}=l,{highlight:o}=l;function a(r){yl.call(this,e,r)}return e.$$set=r=>{"data"in r&&n(0,t=r.data),"selected"in r&&n(1,i=r.selected),"highlight"in r&&n(2,o=r.highlight)},[t,i,o,a]}class Ul extends Te{constructor(l){super(),Ge(this,l,Jl,Xl,Ie,{data:0,selected:1,highlight:2})}}function Qe(e,l,n){const t=e.slice();return t[22]=l[n],t}function Ye(e,l,n){const t=e.slice();return t[22]=l[n],t}function $e(e,l,n){const t=e.slice();return t[27]=l[n],t[29]=n,t}function xe(e,l,n){const t=e.slice();return t[27]=l[n],t}function el(e,l,n){const t=e.slice();return t[22]=l[n],t[29]=n,t}function ll(e,l,n){const t=e.slice();return t[27]=l[n],t[29]=n,t}function tl(e){let l,n,t,i;return{c(){l=se("rect"),this.h()},l(o){l=fe(o,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0,class:!0}),G(l).forEach(v),this.h()},h(){d(l,"x",n=e[14](e[27])),d(l,"y",0),d(l,"width",t=e[14](e[7][e[29]+1])-e[14](e[27])),d(l,"height",100),d(l,"fill",i=e[8][e[29]]),d(l,"class","svelte-1n0fg1i")},m(o,a){N(o,l,a)},p(o,a){a[0]&128&&n!==(n=o[14](o[27]))&&d(l,"x",n),a[0]&128&&t!==(t=o[14](o[7][o[29]+1])-o[14](o[27]))&&d(l,"width",t),a[0]&256&&i!==(i=o[8][o[29]])&&d(l,"fill",i)},d(o){o&&v(l)}}}function nl(e){let l,n,t,i,o,a;function r(){return e[16](e[22])}return{c(){l=se("rect"),this.h()},l(s){l=fe(s,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0,title:!0,role:!0,class:!0}),G(l).forEach(v),this.h()},h(){d(l,"x",n=e[14](e[29]===0?e[7][0]:e[13](e[22][e[2]],e[12][e[29]-1][e[2]]))),d(l,"y",0),d(l,"width",t=e[14]((e[29]===e[12].length-1?e[7][e[7].length-1]:e[13](e[22][e[2]],e[12][e[29]+1][e[2]]))-(e[29]===0?e[7][0]:e[13](e[22][e[2]],e[12][e[29]-1][e[2]])))),d(l,"height",100),d(l,"fill","rgba(0,0,0,0)"),d(l,"title",i=`${e[29]===e[12].length-1?e[7][e[7].length-1]:e[13](e[22][e[2]],e[12][e[29]+1][e[2]])}-${e[29]===0?e[7][0]:e[13](e[22][e[2]],e[12][e[29]-1][e[2]])}`),d(l,"role","none"),d(l,"class","svelte-1n0fg1i")},m(s,f){N(s,l,f),o||(a=Le(l,"mouseenter",r),o=!0)},p(s,f){e=s,f[0]&4228&&n!==(n=e[14](e[29]===0?e[7][0]:e[13](e[22][e[2]],e[12][e[29]-1][e[2]])))&&d(l,"x",n),f[0]&4228&&t!==(t=e[14]((e[29]===e[12].length-1?e[7][e[7].length-1]:e[13](e[22][e[2]],e[12][e[29]+1][e[2]]))-(e[29]===0?e[7][0]:e[13](e[22][e[2]],e[12][e[29]-1][e[2]]))))&&d(l,"width",t),f[0]&4228&&i!==(i=`${e[29]===e[12].length-1?e[7][e[7].length-1]:e[13](e[22][e[2]],e[12][e[29]+1][e[2]])}-${e[29]===0?e[7][0]:e[13](e[22][e[2]],e[12][e[29]-1][e[2]])}`)&&d(l,"title",i)},d(s){s&&v(l),o=!1,a()}}}function il(e){let l,n,t;return{c(){l=se("line"),this.h()},l(i){l=fe(i,"line",{x1:!0,x2:!0,y1:!0,y2:!0,stroke:!0,class:!0}),G(l).forEach(v),this.h()},h(){d(l,"x1",n=e[14](e[27])),d(l,"x2",t=e[14](e[27])),d(l,"y1",0),d(l,"y2",155),d(l,"stroke","white"),d(l,"class","svelte-1n0fg1i")},m(i,o){N(i,l,o)},p(i,o){o[0]&128&&n!==(n=i[14](i[27]))&&d(l,"x1",n),o[0]&128&&t!==(t=i[14](i[27]))&&d(l,"x2",t)},d(i){i&&v(l)}}}function al(e){let l,n=e[9](e[7][e[29]])+"",t;return{c(){l=A("div"),t=Y(n),this.h()},l(i){l=O(i,"DIV",{class:!0,style:!0});var o=G(l);t=$(o,n),o.forEach(v),this.h()},h(){d(l,"class","tick svelte-1n0fg1i"),x(l,"left",e[14](e[27])+"%"),x(l,"transform","translateX("+(e[29]==0&&e[11]?"-2px":"-50%")+")")},m(i,o){N(i,l,o),k(l,t)},p(i,o){o[0]&640&&n!==(n=i[9](i[7][i[29]])+"")&&de(t,n),o[0]&128&&x(l,"left",i[14](i[27])+"%"),o[0]&2048&&x(l,"transform","translateX("+(i[29]==0&&i[11]?"-2px":"-50%")+")")},d(i){i&&v(l)}}}function ol(e){let l,n=J(e[1].filter(e[18])),t=[];for(let i=0;i<n.length;i+=1)t[i]=rl(Ye(e,n,i));return{c(){for(let i=0;i<t.length;i+=1)t[i].c();l=ge()},l(i){for(let o=0;o<t.length;o+=1)t[o].l(i);l=ge()},m(i,o){for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(i,o);N(i,l,o)},p(i,o){if(o[0]&17470){n=J(i[1].filter(i[18]));let a;for(a=0;a<n.length;a+=1){const r=Ye(i,n,a);t[a]?t[a].p(r,o):(t[a]=rl(r),t[a].c(),t[a].m(l.parentNode,l))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},d(i){i&&v(l),ue(t,i)}}}function rl(e){let l,n,t,i=Math.round(e[22][e[2]]).toLocaleString()+"",o,a;return{c(){l=A("div"),n=F(),t=A("div"),o=Y(i),a=Y(e[10]),this.h()},l(r){l=O(r,"DIV",{class:!0,style:!0}),G(l).forEach(v),n=X(r),t=O(r,"DIV",{class:!0,style:!0});var s=G(t);o=$(s,i),a=$(s,e[10]),s.forEach(v),this.h()},h(){d(l,"class","marker svelte-1n0fg1i"),x(l,"width",e[5]+"px"),x(l,"left","calc("+e[14](e[22][e[2]])+"% - "+e[5]/2+"px)"),d(t,"class","value svelte-1n0fg1i"),x(t,"left",e[14](e[22][e[2]])+"%")},m(r,s){N(r,l,s),N(r,n,s),N(r,t,s),k(t,o),k(t,a)},p(r,s){s[0]&32&&x(l,"width",r[5]+"px"),s[0]&62&&x(l,"left","calc("+r[14](r[22][r[2]])+"% - "+r[5]/2+"px)"),s[0]&30&&i!==(i=Math.round(r[22][r[2]]).toLocaleString()+"")&&de(o,i),s[0]&1024&&de(a,r[10]),s[0]&30&&x(t,"left",r[14](r[22][r[2]])+"%")},d(r){r&&(v(l),v(n),v(t))}}}function sl(e){let l,n=J(e[1].filter(e[19])),t=[];for(let i=0;i<n.length;i+=1)t[i]=fl(Qe(e,n,i));return{c(){for(let i=0;i<t.length;i+=1)t[i].c();l=ge()},l(i){for(let o=0;o<t.length;o+=1)t[o].l(i);l=ge()},m(i,o){for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(i,o);N(i,l,o)},p(i,o){if(o[0]&17455){n=J(i[1].filter(i[19]));let a;for(a=0;a<n.length;a+=1){const r=Qe(i,n,a);t[a]?t[a].p(r,o):(t[a]=fl(r),t[a].c(),t[a].m(l.parentNode,l))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},d(i){i&&v(l),ue(t,i)}}}function fl(e){let l,n,t,i=Math.round(e[22][e[2]]).toLocaleString()+"",o,a;return{c(){l=A("div"),n=F(),t=A("div"),o=Y(i),a=Y(e[10]),this.h()},l(r){l=O(r,"DIV",{class:!0,style:!0}),G(l).forEach(v),n=X(r),t=O(r,"DIV",{class:!0,style:!0});var s=G(t);o=$(s,i),a=$(s,e[10]),s.forEach(v),this.h()},h(){d(l,"class","marker marker-hovered svelte-1n0fg1i"),x(l,"width",e[5]+"px"),x(l,"left","calc("+e[14](e[22][e[2]])+"% - "+e[5]/2+"px)"),d(t,"class","value svelte-1n0fg1i"),x(t,"left",e[14](e[22][e[2]])+"%")},m(r,s){N(r,l,s),N(r,n,s),N(r,t,s),k(t,o),k(t,a)},p(r,s){s[0]&32&&x(l,"width",r[5]+"px"),s[0]&47&&x(l,"left","calc("+r[14](r[22][r[2]])+"% - "+r[5]/2+"px)"),s[0]&15&&i!==(i=Math.round(r[22][r[2]]).toLocaleString()+"")&&de(o,i),s[0]&1024&&de(a,r[10]),s[0]&15&&x(t,"left",r[14](r[22][r[2]])+"%")},d(r){r&&(v(l),v(n),v(t))}}}function ql(e){let l,n,t,i,o,a,r,s=e[9](e[7][e[7].length-1])+"",f,_,m,h,b,g,y=J(e[7].slice(0,e[7].length-1)),E=[];for(let u=0;u<y.length;u+=1)E[u]=tl(ll(e,y,u));let P=J(e[12]),T=[];for(let u=0;u<P.length;u+=1)T[u]=nl(el(e,P,u));let j=J(e[7]),w=[];for(let u=0;u<j.length;u+=1)w[u]=il(xe(e,j,u));let C=J(e[7].slice(0,e[7].length-1)),I=[];for(let u=0;u<C.length;u+=1)I[u]=al($e(e,C,u));let z=typeof e[4]=="string"&&ol(e),H=typeof e[0]=="string"&&sl(e);return{c(){l=A("div"),n=se("svg");for(let u=0;u<E.length;u+=1)E[u].c();t=se("rect");for(let u=0;u<T.length;u+=1)T[u].c();i=ge();for(let u=0;u<w.length;u+=1)w[u].c();o=F();for(let u=0;u<I.length;u+=1)I[u].c();a=F(),r=A("div"),f=Y(s),_=Y(e[10]),m=F(),z&&z.c(),h=F(),H&&H.c(),this.h()},l(u){l=O(u,"DIV",{class:!0,style:!0});var S=G(l);n=fe(S,"svg",{viewBox:!0,preserveAspectRatio:!0,role:!0,class:!0});var c=G(n);for(let K=0;K<E.length;K+=1)E[K].l(c);t=fe(c,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,class:!0}),G(t).forEach(v);for(let K=0;K<T.length;K+=1)T[K].l(c);i=ge();for(let K=0;K<w.length;K+=1)w[K].l(c);c.forEach(v),o=X(S);for(let K=0;K<I.length;K+=1)I[K].l(S);a=X(S),r=O(S,"DIV",{class:!0,style:!0});var M=G(r);f=$(M,s),_=$(M,e[10]),M.forEach(v),m=X(S),z&&z.l(S),h=X(S),H&&H.l(S),S.forEach(v),this.h()},h(){d(t,"x",0),d(t,"y",0),d(t,"width",100),d(t,"height",100),d(t,"fill","none"),d(t,"stroke","#999"),d(t,"class","svelte-1n0fg1i"),d(n,"viewBox","0 0 100 100"),d(n,"preserveAspectRatio","none"),d(n,"role","none"),d(n,"class","svelte-1n0fg1i"),d(r,"class","tick svelte-1n0fg1i"),x(r,"right","0"),x(r,"transform","translateX("+(e[11]?"2px":"50%")+")"),d(l,"class","container svelte-1n0fg1i"),x(l,"height",e[6]+"px")},m(u,S){N(u,l,S),k(l,n);for(let c=0;c<E.length;c+=1)E[c]&&E[c].m(n,null);k(n,t);for(let c=0;c<T.length;c+=1)T[c]&&T[c].m(n,null);k(n,i);for(let c=0;c<w.length;c+=1)w[c]&&w[c].m(n,null);k(l,o);for(let c=0;c<I.length;c+=1)I[c]&&I[c].m(l,null);k(l,a),k(l,r),k(r,f),k(r,_),k(l,m),z&&z.m(l,null),k(l,h),H&&H.m(l,null),b||(g=Le(n,"mouseleave",e[17]),b=!0)},p(u,S){if(S[0]&16768){y=J(u[7].slice(0,u[7].length-1));let c;for(c=0;c<y.length;c+=1){const M=ll(u,y,c);E[c]?E[c].p(M,S):(E[c]=tl(M),E[c].c(),E[c].m(n,t))}for(;c<E.length;c+=1)E[c].d(1);E.length=y.length}if(S[0]&61580){P=J(u[12]);let c;for(c=0;c<P.length;c+=1){const M=el(u,P,c);T[c]?T[c].p(M,S):(T[c]=nl(M),T[c].c(),T[c].m(n,i))}for(;c<T.length;c+=1)T[c].d(1);T.length=P.length}if(S[0]&16512){j=J(u[7]);let c;for(c=0;c<j.length;c+=1){const M=xe(u,j,c);w[c]?w[c].p(M,S):(w[c]=il(M),w[c].c(),w[c].m(n,null))}for(;c<w.length;c+=1)w[c].d(1);w.length=j.length}if(S[0]&19072){C=J(u[7].slice(0,u[7].length-1));let c;for(c=0;c<C.length;c+=1){const M=$e(u,C,c);I[c]?I[c].p(M,S):(I[c]=al(M),I[c].c(),I[c].m(l,a))}for(;c<I.length;c+=1)I[c].d(1);I.length=C.length}S[0]&640&&s!==(s=u[9](u[7][u[7].length-1])+"")&&de(f,s),S[0]&1024&&de(_,u[10]),S[0]&2048&&x(r,"transform","translateX("+(u[11]?"2px":"50%")+")"),typeof u[4]=="string"?z?z.p(u,S):(z=ol(u),z.c(),z.m(l,h)):z&&(z.d(1),z=null),typeof u[0]=="string"?H?H.p(u,S):(H=sl(u),H.c(),H.m(l,null)):H&&(H.d(1),H=null),S[0]&64&&x(l,"height",u[6]+"px")},i:be,o:be,d(u){u&&v(l),ue(E,u),ue(T,u),ue(w,u),ue(I,u),z&&z.d(),H&&H.d(),b=!1,g()}}}function Ql(e,l,n){let t;const i=Sl();let{data:o}=l,{valueKey:a="value"}=l,{idKey:r="id"}=l,{hovered:s=null}=l,{selected:f=null}=l,{lineWidth:_=3}=l,{height:m=20}=l,{breaks:h=[0,10,25,50,75,100]}=l,{colors:b=["rgba(255,255,255,0.0)","rgba(255,255,255,0.1)","rgba(255,255,255,0.2)","rgba(255,255,255,0.3)","rgba(255,255,255,0.4)"]}=l,{formatTick:g=u=>Math.round(u).toLocaleString()}=l,{suffix:y=""}=l,{snapTicks:E=!0}=l;const P=(u,S)=>{const c=[...u].sort((V,B)=>V[S]-B[S]),M=c.map(V=>V[S]),K=[];for(let V=0;V<c.length-1;V++)M.indexOf(c[V][S])===V&&K.push(c[V]);return K},T=(u,S)=>(u+S)/2,j=u=>100*((u-h[0])/(h[h.length-1]-h[0])),w=u=>{n(0,s=u),i("hover",{id:u})},C=u=>w(u[r]),I=()=>w(null),z=u=>u[r]===f,H=u=>u[r]===s;return e.$$set=u=>{"data"in u&&n(1,o=u.data),"valueKey"in u&&n(2,a=u.valueKey),"idKey"in u&&n(3,r=u.idKey),"hovered"in u&&n(0,s=u.hovered),"selected"in u&&n(4,f=u.selected),"lineWidth"in u&&n(5,_=u.lineWidth),"height"in u&&n(6,m=u.height),"breaks"in u&&n(7,h=u.breaks),"colors"in u&&n(8,b=u.colors),"formatTick"in u&&n(9,g=u.formatTick),"suffix"in u&&n(10,y=u.suffix),"snapTicks"in u&&n(11,E=u.snapTicks)},e.$$.update=()=>{e.$$.dirty[0]&6&&n(12,t=P(o,a))},[s,o,a,r,f,_,m,h,b,g,y,E,t,T,j,w,C,I,z,H]}class Yl extends Te{constructor(l){super(),Ge(this,l,Ql,ql,Ie,{data:1,valueKey:2,idKey:3,hovered:0,selected:4,lineWidth:5,height:6,breaks:7,colors:8,formatTick:9,suffix:10,snapTicks:11},null,[-1,-1])}}function hl(e){let l,n,t,i;function o(r){e[5](r)}let a={data:e[1][e[2]],breaks:e[1][`${e[2]}Breaks`],idKey:"code"};return e[0]!==void 0&&(a.hovered=e[0]),n=new Yl({props:a}),Me.push(()=>Ae(n,"hovered",o)),n.$on("hover",e[6]),{c(){l=A("div"),ie(n.$$.fragment),this.h()},l(r){l=O(r,"DIV",{class:!0});var s=G(l);ae(n.$$.fragment,s),s.forEach(v),this.h()},h(){d(l,"class","breaks-palette svelte-1173c3d")},m(r,s){N(r,l,s),oe(n,l,null),i=!0},p(r,s){const f={};s&6&&(f.data=r[1][r[2]]),s&6&&(f.breaks=r[1][`${r[2]}Breaks`]),!t&&s&1&&(t=!0,f.hovered=r[0],Pe(()=>t=!1)),n.$set(f)},i(r){i||(D(n.$$.fragment,r),i=!0)},o(r){Z(n.$$.fragment,r),i=!1},d(r){r&&v(l),re(n)}}}function $l(e){let l,n,t=e[1]&&hl(e);return{c(){t&&t.c(),l=ge()},l(i){t&&t.l(i),l=ge()},m(i,o){t&&t.m(i,o),N(i,l,o),n=!0},p(i,[o]){i[1]?t?(t.p(i,o),o&2&&D(t,1)):(t=hl(i),t.c(),D(t,1),t.m(l.parentNode,l)):t&&(ye(),Z(t,1,1,()=>{t=null}),Ee())},i(i){n||(D(t),n=!0)},o(i){Z(t),n=!1},d(i){i&&v(l),t&&t.d(i)}}}function xl(e,l,n){let{data:t}=l,{journeys:i}=l,{selected:o}=l,{hovered:a}=l,{highlight:r}=l;function s(_){a=_,n(0,a)}function f(_){yl.call(this,e,_)}return e.$$set=_=>{"data"in _&&n(3,t=_.data),"journeys"in _&&n(1,i=_.journeys),"selected"in _&&n(4,o=_.selected),"hovered"in _&&n(0,a=_.hovered),"highlight"in _&&n(2,r=_.highlight)},[a,i,r,t,o,s,f]}class et extends Te{constructor(l){super(),Ge(this,l,xl,$l,Ie,{data:3,journeys:1,selected:4,hovered:0,highlight:2})}}function ul(e,l,n){const t=e.slice();return t[43]=l[n],t}function gl(e){let l,n;return l=new Ul({props:{data:e[5],selected:e[1],highlight:e[7]}}),l.$on("change",e[14]),{c(){ie(l.$$.fragment)},l(t){ae(l.$$.fragment,t)},m(t,i){oe(l,t,i),n=!0},p(t,i){const o={};i[0]&32&&(o.data=t[5]),i[0]&2&&(o.selected=t[1]),i[0]&128&&(o.highlight=t[7]),l.$set(o)},i(t){n||(D(l.$$.fragment,t),n=!0)},o(t){Z(l.$$.fragment,t),n=!1},d(t){re(l,t)}}}function _l(e){let l,n,t;function i(a){e[21](a)}let o={data:e[5],journeys:e[3],selected:e[1],highlight:e[7]};return e[2]!==void 0&&(o.hovered=e[2]),l=new et({props:o}),Me.push(()=>Ae(l,"hovered",i)),l.$on("hover",e[15]),{c(){ie(l.$$.fragment)},l(a){ae(l.$$.fragment,a)},m(a,r){oe(l,a,r),t=!0},p(a,r){const s={};r[0]&32&&(s.data=a[5]),r[0]&8&&(s.journeys=a[3]),r[0]&2&&(s.selected=a[1]),r[0]&128&&(s.highlight=a[7]),!n&&r[0]&4&&(n=!0,s.hovered=a[2],Pe(()=>n=!1)),l.$set(s)},i(a){t||(D(l.$$.fragment,a),t=!0)},o(a){Z(l.$$.fragment,a),t=!1},d(a){re(l,a)}}}function cl(e){let l,n,t,i,o,a=J(e[11]),r=[];for(let f=0;f<a.length;f+=1)r[f]=dl(ul(e,a,f));const s=f=>Z(r[f],1,1,()=>{r[f]=null});return n=new Ve({props:{id:"overlay-lines",type:"geojson",data:e[12].lines,$$slots:{default:[tt]},$$scope:{ctx:e}}}),i=new Ve({props:{id:"overlay-points",type:"geojson",data:e[12].points,$$slots:{default:[nt]},$$scope:{ctx:e}}}),{c(){for(let f=0;f<r.length;f+=1)r[f].c();l=F(),ie(n.$$.fragment),t=F(),ie(i.$$.fragment)},l(f){for(let _=0;_<r.length;_+=1)r[_].l(f);l=X(f),ae(n.$$.fragment,f),t=X(f),ae(i.$$.fragment,f)},m(f,_){for(let m=0;m<r.length;m+=1)r[m]&&r[m].m(f,_);N(f,l,_),oe(n,f,_),N(f,t,_),oe(i,f,_),o=!0},p(f,_){if(_[0]&51422){a=J(f[11]);let b;for(b=0;b<a.length;b+=1){const g=ul(f,a,b);r[b]?(r[b].p(g,_),D(r[b],1)):(r[b]=dl(g),r[b].c(),D(r[b],1),r[b].m(l.parentNode,l))}for(ye(),b=a.length;b<r.length;b+=1)s(b);Ee()}const m={};_[0]&4096&&(m.data=f[12].lines),_[0]&16777216&&(m.$$scope={dirty:_,ctx:f}),n.$set(m);const h={};_[0]&4096&&(h.data=f[12].points),_[0]&16777216&&(h.$$scope={dirty:_,ctx:f}),i.$set(h)},i(f){if(!o){for(let _=0;_<a.length;_+=1)D(r[_]);D(n.$$.fragment,f),D(i.$$.fragment,f),o=!0}},o(f){r=r.filter(Boolean);for(let _=0;_<r.length;_+=1)Z(r[_]);Z(n.$$.fragment,f),Z(i.$$.fragment,f),o=!1},d(f){f&&(v(l),v(t)),ue(r,f),re(n,f),re(i,f)}}}function lt(e){let l,n,t,i,o,a,r,s,f;function _(h){e[22](h)}let m={id:e[43].key+"-fill",type:"fill",data:e[3]?e[3][e[7]]:[],idKey:"code",paint:{"fill-color":["case",["!=",["feature-state","color"],null],["feature-state","color"],"rgba(255, 255, 255, 0)"]},order:"place_suburb",hover:!0,select:!0,selected:e[1],highlight:!0,highlighted:e[6],visible:e[4]===e[43].key};return e[2]!==void 0&&(m.hovered=e[2]),l=new Be({props:m}),Me.push(()=>Ae(l,"hovered",_)),l.$on("hover",e[15]),l.$on("select",e[14]),i=new Be({props:{id:e[43].key+"-line",type:"line",paint:{"line-color":"#555","line-width":.5},order:"place_other",visible:e[4]===e[43].key}}),a=new Be({props:{id:e[43].key+"-highlighted",type:"line",paint:{"line-color":["case",["==",["feature-state","highlighted"],!0],"#aaa","rgba(0,0,0,0)"],"line-width":1},order:"place_other",visible:e[4]===e[43].key}}),s=new Be({props:{id:e[43].key+"-selected",type:"line",paint:{"line-color":["case",["==",["feature-state","selected"],!0],"white",["==",["feature-state","hovered"],!0],"white","rgba(0,0,0,0)"],"line-width":["case",["==",["feature-state","selected"],!0],2.5,1]},order:"place_other",visible:e[4]===e[43].key}}),{c(){ie(l.$$.fragment),t=F(),ie(i.$$.fragment),o=F(),ie(a.$$.fragment),r=F(),ie(s.$$.fragment)},l(h){ae(l.$$.fragment,h),t=X(h),ae(i.$$.fragment,h),o=X(h),ae(a.$$.fragment,h),r=X(h),ae(s.$$.fragment,h)},m(h,b){oe(l,h,b),N(h,t,b),oe(i,h,b),N(h,o,b),oe(a,h,b),N(h,r,b),oe(s,h,b),f=!0},p(h,b){const g={};b[0]&2048&&(g.id=h[43].key+"-fill"),b[0]&136&&(g.data=h[3]?h[3][h[7]]:[]),b[0]&2&&(g.selected=h[1]),b[0]&64&&(g.highlighted=h[6]),b[0]&2064&&(g.visible=h[4]===h[43].key),!n&&b[0]&4&&(n=!0,g.hovered=h[2],Pe(()=>n=!1)),l.$set(g);const y={};b[0]&2048&&(y.id=h[43].key+"-line"),b[0]&2064&&(y.visible=h[4]===h[43].key),i.$set(y);const E={};b[0]&2048&&(E.id=h[43].key+"-highlighted"),b[0]&2064&&(E.visible=h[4]===h[43].key),a.$set(E);const P={};b[0]&2048&&(P.id=h[43].key+"-selected"),b[0]&2064&&(P.visible=h[4]===h[43].key),s.$set(P)},i(h){f||(D(l.$$.fragment,h),D(i.$$.fragment,h),D(a.$$.fragment,h),D(s.$$.fragment,h),f=!0)},o(h){Z(l.$$.fragment,h),Z(i.$$.fragment,h),Z(a.$$.fragment,h),Z(s.$$.fragment,h),f=!1},d(h){h&&(v(t),v(o),v(r)),re(l,h),re(i,h),re(a,h),re(s,h)}}}function dl(e){let l,n;const t=[{id:e[43].key},{type:e[43].type},{promoteId:"areacd"},e[43].props];let i={$$slots:{default:[lt]},$$scope:{ctx:e}};for(let o=0;o<t.length;o+=1)i=Gl(i,t[o]);return l=new Ve({props:i}),{c(){ie(l.$$.fragment)},l(o){ae(l.$$.fragment,o)},m(o,a){oe(l,o,a),n=!0},p(o,a){const r=a[0]&2048?Ml(t,[{id:o[43].key},{type:o[43].type},t[2],Pl(o[43].props)]):{};a[0]&16779486&&(r.$$scope={dirty:a,ctx:o}),l.$set(r)},i(o){n||(D(l.$$.fragment,o),n=!0)},o(o){Z(l.$$.fragment,o),n=!1},d(o){re(l,o)}}}function tt(e){let l,n;return l=new Be({props:{id:"overlay-lines",type:"line",paint:{"line-color":"white","line-width":1},order:"place_other"}}),{c(){ie(l.$$.fragment)},l(t){ae(l.$$.fragment,t)},m(t,i){oe(l,t,i),n=!0},p:be,i(t){n||(D(l.$$.fragment,t),n=!0)},o(t){Z(l.$$.fragment,t),n=!1},d(t){re(l,t)}}}function nt(e){let l,n;return l=new Be({props:{id:"overlay-points",type:"circle",paint:{"circle-color":"white","circle-radius":3},order:"place_other"}}),{c(){ie(l.$$.fragment)},l(t){ae(l.$$.fragment,t)},m(t,i){oe(l,t,i),n=!0},p:be,i(t){n||(D(l.$$.fragment,t),n=!0)},o(t){Z(l.$$.fragment,t),n=!1},d(t){re(l,t)}}}function it(e){let l,n,t=e[11][1].props.data&&cl(e);return{c(){t&&t.c(),l=ge()},l(i){t&&t.l(i),l=ge()},m(i,o){t&&t.m(i,o),N(i,l,o),n=!0},p(i,o){i[11][1].props.data?t?(t.p(i,o),o[0]&2048&&D(t,1)):(t=cl(i),t.c(),D(t,1),t.m(l.parentNode,l)):t&&(ye(),Z(t,1,1,()=>{t=null}),Ee())},i(i){n||(D(t),n=!0)},o(i){Z(t),n=!1},d(i){i&&v(l),t&&t.d(i)}}}function at(e){let l,n,t,i,o,a,r;const s=e[20].default,f=Ll(s,e,e[24],null);let _=e[9]&&gl(e),m=e[10]&&_l(e);function h(g){e[23](g)}let b={style:Nl+"/data/style.json",location:{bounds:jl.ew},options:{antialias:!0},interactive:e[8],controls:e[8],$$slots:{default:[it]},$$scope:{ctx:e}};return e[0]!==void 0&&(b.map=e[0]),o=new Cl({props:b}),Me.push(()=>Ae(o,"map",h)),o.$on("load",e[13]),{c(){l=A("div"),f&&f.c(),n=F(),_&&_.c(),t=F(),m&&m.c(),i=F(),ie(o.$$.fragment),this.h()},l(g){l=O(g,"DIV",{class:!0});var y=G(l);f&&f.l(y),n=X(y),_&&_.l(y),t=X(y),m&&m.l(y),i=X(y),ae(o.$$.fragment,y),y.forEach(v),this.h()},h(){d(l,"class","map svelte-1jag0v4")},m(g,y){N(g,l,y),f&&f.m(l,null),k(l,n),_&&_.m(l,null),k(l,t),m&&m.m(l,null),k(l,i),oe(o,l,null),r=!0},p(g,y){f&&f.p&&(!r||y[0]&16777216)&&Bl(f,s,g,g[24],r?Tl(s,g[24],y,null):Il(g[24]),null),g[9]?_?(_.p(g,y),y[0]&512&&D(_,1)):(_=gl(g),_.c(),D(_,1),_.m(l,t)):_&&(ye(),Z(_,1,1,()=>{_=null}),Ee()),g[10]?m?(m.p(g,y),y[0]&1024&&D(m,1)):(m=_l(g),m.c(),D(m,1),m.m(l,i)):m&&(ye(),Z(m,1,1,()=>{m=null}),Ee());const E={};y[0]&256&&(E.interactive=g[8]),y[0]&256&&(E.controls=g[8]),y[0]&16783582&&(E.$$scope={dirty:y,ctx:g}),!a&&y[0]&1&&(a=!0,E.map=g[0],Pe(()=>a=!1)),o.$set(E)},i(g){r||(D(f,g),D(_),D(m),D(o.$$.fragment,g),r=!0)},o(g){Z(f,g),Z(_),Z(m),Z(o.$$.fragment,g),r=!1},d(g){g&&v(l),f&&f.d(g),_&&_.d(),m&&m.d(),re(o)}}}function ot(e,l,n){let{$$slots:t={},$$scope:i}=l;const o=Kl([5,14],[.5,4]),a={work:[39,160,204],migration:[246,96,104]};let{data:r}=l,{map:s=null}=l,{selected:f}=l,{hovered:_}=l,{highlighted:m}=l,{journeys:h}=l,{geo:b="lad"}=l,{pos:g="from"}=l,{highlight:y="from"}=l,{filter:E=!0}=l,{color:P=a.work}=l,{pixelRatio:T=1}=l,{interactive:j=!0}=l,{showInfo:w=!0}=l,{showBreaks:C=!0}=l,I,z,H,u,S,c,M,K,V,B,W=ze();function L(){n(11,I=r.sources),z=r.points,H=z.array.length;const p=U=>(S=Al(U),c=Ol(S),K=c.buffer(z[g],{duration:5e3,ease:"linear"}),V=S.buffer(Array.from({length:H},()=>.7)),{render:c({vert:`
      precision lowp float;
      uniform mat4 uMatrix;
      uniform float pointSize;
      uniform vec3 pointColor;
      attribute vec2 position;
			attribute float opacity;
			varying vec4 fragColor;

      void main() {
        gl_PointSize = pointSize;
        gl_Position = uMatrix * vec4(position, 0, 1);
        fragColor = vec4(pointColor, opacity);
      }
        `,frag:`
      precision lowp float;
			varying vec4 fragColor;

      void main() {
        if (length(gl_PointCoord.xy - 0.5) > 0.5) {
          discard;
        }
        gl_FragColor = fragColor;
      }
      `,attributes:{position:K,opacity:V},uniforms:{pointSize:S.prop("pointSize")||2,pointColor:S.prop("pointColor"),uMatrix:S.prop("uMatrix")},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},depth:{enable:!1},count:H,primitive:"points"})});n(16,T=window.devicePixelRatio>1.5?1.5:window.devicePixelRatio),s.setPixelRatio(T),s.addLayer({id:"custom_layer",type:"custom",onAdd:(U,le)=>{M=p(le),S.frame(()=>{U&&u&&U.triggerRepaint()})},render(U,le){B=le,u=s.getZoom(),M.render({uMatrix:B,pointSize:o(u)*T,pointColor:P.map(ne=>ne/255)})}},"place_suburb")}let q=y;function pe(p=q){f&&(V({data:E?z.array.map(U=>U[`${p==="to"?"from":"to"}_${b}`]===f?1:.01):Array.from({length:z.array.length},()=>.7)}),q=p)}let he=j;function me(p){const U=["boxZoom","doubleClickZoom","dragPan","dragRotate","keyboard","scrollZoom","touchPitch","touchZoomRotate"];if(he!==p){for(const le of U)s&&p?s[le].enable():s&&s[le].disable();he=p}}let _e=g;function ke(p,U=5e3){_e!==p&&(K.update(z[p],U?{duration:U}:null),_e=p)}function Q(p){const U=p.from.slice(0,p.from.map(te=>te.color).indexOf("rgba(255,255,255,0.0)")),le=p.to.slice(0,p.from.map(te=>te.color).indexOf("rgba(255,255,255,0.0)"));return Array.from(new Set([...U.map(te=>te.code),...le.map(te=>te.code)])).map(te=>{const ce=r.metadata[te];return[ce.xmin,ce.ymin,ce.xmax,ce.ymax]}).reduce((te,ce)=>[Math.min(te[0],ce[0]),Math.min(te[1],ce[1]),Math.max(te[2],ce[2]),Math.max(te[3],ce[3])])}async function R(p){var le,ne;const U=typeof p=="string"?p:((le=p==null?void 0:p.detail)==null?void 0:le.id)||((ne=p==null?void 0:p.detail)==null?void 0:ne.areacd);if(console.debug("select",p,U),U){n(4,b=["E02","W02"].includes(U.slice(0,3))?"msoa":"lad"),n(3,h=await zl(U)),n(1,f=U),pe();const we=Q(h);s.fitBounds(we)}}function ee(p){var le,ne,we,te;const U=typeof p=="string"?p:((le=p==null?void 0:p.detail)==null?void 0:le.id)||((ne=p==null?void 0:p.detail)==null?void 0:ne.areacd);console.log(f,U),n(12,W=ze((we=r.metadata)==null?void 0:we[f],(te=r.metadata)==null?void 0:te[U])),console.log(W)}function ve(p){_=p,n(2,_)}function Re(p){_=p,n(2,_)}function Ce(p){s=p,n(0,s)}return e.$$set=p=>{"data"in p&&n(5,r=p.data),"map"in p&&n(0,s=p.map),"selected"in p&&n(1,f=p.selected),"hovered"in p&&n(2,_=p.hovered),"highlighted"in p&&n(6,m=p.highlighted),"journeys"in p&&n(3,h=p.journeys),"geo"in p&&n(4,b=p.geo),"pos"in p&&n(17,g=p.pos),"highlight"in p&&n(7,y=p.highlight),"filter"in p&&n(18,E=p.filter),"color"in p&&n(19,P=p.color),"pixelRatio"in p&&n(16,T=p.pixelRatio),"interactive"in p&&n(8,j=p.interactive),"showInfo"in p&&n(9,w=p.showInfo),"showBreaks"in p&&n(10,C=p.showBreaks),"$$scope"in p&&n(24,i=p.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&128&&pe(y),e.$$.dirty[0]&256&&me(j),e.$$.dirty[0]&131072&&ke(g)},[s,f,_,h,b,r,m,y,j,w,C,I,W,L,R,ee,T,g,E,P,t,ve,Re,Ce,i]}class rt extends Te{constructor(l){super(),Ge(this,l,ot,at,Ie,{data:5,map:0,selected:1,hovered:2,highlighted:6,journeys:3,geo:4,pos:17,highlight:7,filter:18,color:19,pixelRatio:16,interactive:8,showInfo:9,showBreaks:10},null,[-1,-1])}}function ml(e,l,n){const t=e.slice();return t[12]=l[n],t}function vl(e,l,n){const t=e.slice();return t[15]=l[n],t}function pl(e,l,n){const t=e.slice();return t[18]=l[n],t}function bl(e){let l,n=e[18]+"",t;return{c(){l=A("option"),t=Y(n),this.h()},l(i){l=O(i,"OPTION",{});var o=G(l);t=$(o,n),o.forEach(v),this.h()},h(){l.__value=e[18],Ne(l,l.__value)},m(i,o){N(i,l,o),k(l,t)},p:be,d(i){i&&v(l)}}}function kl(e){let l,n=e[15]==="from"?"origin":"destination",t;return{c(){l=A("option"),t=Y(n),this.h()},l(i){l=O(i,"OPTION",{});var o=G(l);t=$(o,n),o.forEach(v),this.h()},h(){l.__value=e[15],Ne(l,l.__value)},m(i,o){N(i,l,o),k(l,t)},p:be,d(i){i&&v(l)}}}function wl(e){let l,n=e[12]==="from"?"works here":"lives here",t;return{c(){l=A("option"),t=Y(n),this.h()},l(i){l=O(i,"OPTION",{});var o=G(l);t=$(o,n),o.forEach(v),this.h()},h(){l.__value=e[12],Ne(l,l.__value)},m(i,o){N(i,l,o),k(l,t)},p:be,d(i){i&&v(l)}}}function st(e){let l,n,t,i,o,a,r,s,f,_,m,h,b,g,y,E,P,T,j,w,C,I,z,H,u=J(e[5]),S=[];for(let B=0;B<u.length;B+=1)S[B]=bl(pl(e,u,B));let c=J(e[6]),M=[];for(let B=0;B<c.length;B+=1)M[B]=kl(vl(e,c,B));let K=J(e[7]),V=[];for(let B=0;B<K.length;B+=1)V[B]=wl(ml(e,K,B));return{c(){l=A("div"),n=A("label"),t=A("input"),i=Y(`
        Interactive`),o=F(),a=A("label"),r=Y("Geo type"),s=A("br"),f=F(),_=A("select");for(let B=0;B<S.length;B+=1)S[B].c();m=F(),h=A("label"),b=Y("Point location"),g=A("br"),y=F(),E=A("select");for(let B=0;B<M.length;B+=1)M[B].c();P=F(),T=A("label"),j=Y("Highlight"),w=A("br"),C=F(),I=A("select");for(let B=0;B<V.length;B+=1)V[B].c();this.h()},l(B){l=O(B,"DIV",{class:!0});var W=G(l);n=O(W,"LABEL",{class:!0});var L=G(n);t=O(L,"INPUT",{type:!0}),i=$(L,`
        Interactive`),L.forEach(v),o=X(W),a=O(W,"LABEL",{class:!0});var q=G(a);r=$(q,"Geo type"),s=O(q,"BR",{}),f=X(q),_=O(q,"SELECT",{});var pe=G(_);for(let Q=0;Q<S.length;Q+=1)S[Q].l(pe);pe.forEach(v),q.forEach(v),m=X(W),h=O(W,"LABEL",{class:!0});var he=G(h);b=$(he,"Point location"),g=O(he,"BR",{}),y=X(he),E=O(he,"SELECT",{});var me=G(E);for(let Q=0;Q<M.length;Q+=1)M[Q].l(me);me.forEach(v),he.forEach(v),P=X(W),T=O(W,"LABEL",{class:!0});var _e=G(T);j=$(_e,"Highlight"),w=O(_e,"BR",{}),C=X(_e),I=O(_e,"SELECT",{});var ke=G(I);for(let Q=0;Q<V.length;Q+=1)V[Q].l(ke);ke.forEach(v),_e.forEach(v),W.forEach(v),this.h()},h(){d(t,"type","checkbox"),d(n,"class","svelte-1u46gza"),e[2]===void 0&&De(()=>e[9].call(_)),d(a,"class","svelte-1u46gza"),e[3]===void 0&&De(()=>e[10].call(E)),d(h,"class","svelte-1u46gza"),e[4]===void 0&&De(()=>e[11].call(I)),d(T,"class","svelte-1u46gza"),d(l,"class","toggles svelte-1u46gza")},m(B,W){N(B,l,W),k(l,n),k(n,t),t.checked=e[1],k(n,i),k(l,o),k(l,a),k(a,r),k(a,s),k(a,f),k(a,_);for(let L=0;L<S.length;L+=1)S[L]&&S[L].m(_,null);Se(_,e[2],!0),k(l,m),k(l,h),k(h,b),k(h,g),k(h,y),k(h,E);for(let L=0;L<M.length;L+=1)M[L]&&M[L].m(E,null);Se(E,e[3],!0),k(l,P),k(l,T),k(T,j),k(T,w),k(T,C),k(T,I);for(let L=0;L<V.length;L+=1)V[L]&&V[L].m(I,null);Se(I,e[4],!0),z||(H=[Le(t,"change",e[8]),Le(_,"change",e[9]),Le(E,"change",e[10]),Le(I,"change",e[11])],z=!0)},p(B,W){if(W&2&&(t.checked=B[1]),W&32){u=J(B[5]);let L;for(L=0;L<u.length;L+=1){const q=pl(B,u,L);S[L]?S[L].p(q,W):(S[L]=bl(q),S[L].c(),S[L].m(_,null))}for(;L<S.length;L+=1)S[L].d(1);S.length=u.length}if(W&36&&Se(_,B[2]),W&64){c=J(B[6]);let L;for(L=0;L<c.length;L+=1){const q=vl(B,c,L);M[L]?M[L].p(q,W):(M[L]=kl(q),M[L].c(),M[L].m(E,null))}for(;L<M.length;L+=1)M[L].d(1);M.length=c.length}if(W&72&&Se(E,B[3]),W&128){K=J(B[7]);let L;for(L=0;L<K.length;L+=1){const q=ml(B,K,L);V[L]?V[L].p(q,W):(V[L]=wl(q),V[L].c(),V[L].m(I,null))}for(;L<V.length;L+=1)V[L].d(1);V.length=K.length}W&144&&Se(I,B[4])},d(B){B&&v(l),ue(S,B),ue(M,B),ue(V,B),z=!1,Rl(H)}}}function ft(e){let l,n;return l=new rt({props:{data:e[0],interactive:e[1],geo:e[2],pos:e[3],highlight:e[4],$$slots:{default:[st]},$$scope:{ctx:e}}}),{c(){ie(l.$$.fragment)},l(t){ae(l.$$.fragment,t)},m(t,i){oe(l,t,i),n=!0},p(t,i){const o={};i&1&&(o.data=t[0]),i&2&&(o.interactive=t[1]),i&4&&(o.geo=t[2]),i&8&&(o.pos=t[3]),i&16&&(o.highlight=t[4]),i&2097182&&(o.$$scope={dirty:i,ctx:t}),l.$set(o)},i(t){n||(D(l.$$.fragment,t),n=!0)},o(t){Z(l.$$.fragment,t),n=!1},d(t){re(l,t)}}}function ht(e){let l,n;return l=new Vl({props:{theme:"dark",$$slots:{default:[ft]},$$scope:{ctx:e}}}),{c(){ie(l.$$.fragment)},l(t){ae(l.$$.fragment,t)},m(t,i){oe(l,t,i),n=!0},p(t,[i]){const o={};i&2097183&&(o.$$scope={dirty:i,ctx:t}),l.$set(o)},i(t){n||(D(l.$$.fragment,t),n=!0)},o(t){Z(l.$$.fragment,t),n=!1},d(t){re(l,t)}}}function ut(e,l,n){let{data:t}=l;const i=["lad","msoa"],o=["from","to"],a=["from","to"];let r=!0,s=i[0],f=o[0],_=a[0];function m(){r=this.checked,n(1,r)}function h(){s=Oe(this),n(2,s),n(5,i)}function b(){f=Oe(this),n(3,f),n(6,o)}function g(){_=Oe(this),n(4,_),n(7,a)}return e.$$set=y=>{"data"in y&&n(0,t=y.data)},[t,r,s,f,_,i,o,a,m,h,b,g]}class bt extends Te{constructor(l){super(),Ge(this,l,ut,ht,Ie,{data:0})}}export{bt as component,pt as universal};
