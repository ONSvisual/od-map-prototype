//js
import{b as d}from"../chunks/paths.e1fbdf68.js";import{m as h,c as y,a as b,p as x}from"../chunks/utils.9e297d88.js";import{s as S,r as j,u as P,v as k,w as C}from"../chunks/scheduler.42865049.js";import{S as F,i as M,a as O,t as L}from"../chunks/index.156b26f3.js";function E(t){return t}function G(t){if(t==null)return E;var e,i,r=t.scale[0],a=t.scale[1],l=t.translate[0],f=t.translate[1];return function(p,_){_||(e=i=0);var u=2,o=p.length,s=new Array(o);for(s[0]=(e+=p[0])*r+l,s[1]=(i+=p[1])*a+f;u<o;)s[u]=p[u],++u;return s}}function J(t,e){for(var i,r=t.length,a=r-e;a<--r;)i=t[a],t[a++]=t[r],t[r]=i}function N(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(i){return $(t,i)})}:$(t,e)}function $(t,e){var i=e.id,r=e.bbox,a=e.properties==null?{}:e.properties,l=T(t,e);return i==null&&r==null?{type:"Feature",properties:a,geometry:l}:r==null?{type:"Feature",id:i,properties:a,geometry:l}:{type:"Feature",id:i,bbox:r,properties:a,geometry:l}}function T(t,e){var i=G(t.transform),r=t.arcs;function a(o,s){s.length&&s.pop();for(var c=r[o<0?~o:o],m=0,g=c.length;m<g;++m)s.push(i(c[m],m));o<0&&J(s,g)}function l(o){return i(o)}function f(o){for(var s=[],c=0,m=o.length;c<m;++c)a(o[c],s);return s.length<2&&s.push(s[0]),s}function p(o){for(var s=f(o);s.length<4;)s.push(s[0]);return s}function _(o){return o.map(p)}function u(o){var s=o.type,c;switch(s){case"GeometryCollection":return{type:s,geometries:o.geometries.map(u)};case"Point":c=l(o.coordinates);break;case"MultiPoint":c=o.coordinates.map(l);break;case"LineString":c=f(o.arcs);break;case"MultiLineString":c=o.arcs.map(f);break;case"Polygon":c=_(o.arcs);break;case"MultiPolygon":c=o.arcs.map(_);break;default:return null}return{type:s,coordinates:c}}return u(e)}const q=!0,z="always";async function A({fetch:t}){let e=JSON.parse(JSON.stringify(h)),i,r,a={};const l=N(await(await t(`${d}/data/lad11_bsc.json`)).json(),"lad"),f=await(await t(`${d}/data/lad11_metadata.csv`)).text(),p=await(await t(`${d}/data/msoa11_metadata.csv`)).text(),_=[...y(await f,b),...y(await p,b)].map(n=>({...n,x:(n.xmin+n.xmax)/2,y:(n.ymin+n.ymax)/2})).sort((n,w)=>n.areanm.localeCompare(w.areanm)),u={};_.forEach(n=>u[n.areacd]=n),r=u,e[1].props.data=l;const o=await t(`${d}/data/lad11_data.csv`),s=await t(`${d}/data/msoa11_data.csv`),c=[...y(await o.text(),b),...y(await s.text(),b)],m={};c.forEach(n=>m[n.areacd]=n),i=m;const g=await t(`${d}/data/msoa11_points.csv`);return a.array=y(await g.text(),n=>{var w,v;return{from_msoa:n.from,from_lad:((w=r[n.from])==null?void 0:w.parentcd)||n.from,to_msoa:n.to,to_lad:((v=r[n.to])==null?void 0:v.parentcd)||n.to,x1:+n.x1,y1:+n.y1,x2:+n.x2,y2:+n.y2}}),a.from=a.array.map(n=>x([n.x1,n.y1])),a.to=a.array.map(n=>x([n.x2,n.y2])),{arealist:_,areadata:i,metadata:r,sources:e,points:a}}const R=Object.freeze(Object.defineProperty({__proto__:null,load:A,prerender:q,trailingSlash:z},Symbol.toStringTag,{value:"Module"}));function B(t){let e;const i=t[1].default,r=j(i,t,t[0],null);return{c(){r&&r.c()},l(a){r&&r.l(a)},m(a,l){r&&r.m(a,l),e=!0},p(a,[l]){r&&r.p&&(!e||l&1)&&P(r,i,a,a[0],e?C(i,a[0],l,null):k(a[0]),null)},i(a){e||(O(r,a),e=!0)},o(a){L(r,a),e=!1},d(a){r&&r.d(a)}}}function D(t,e,i){let{$$slots:r={},$$scope:a}=e;return t.$$set=l=>{"$$scope"in l&&i(0,a=l.$$scope)},[a,r]}class U extends F{constructor(e){super(),M(this,e,D,B,S,{})}}export{U as component,R as universal};
