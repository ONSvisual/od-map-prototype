//js
import{s as ze,a as M,e as he,c as V,i as L,y as be,d as _,A as me,f as D,g as T,h as N,j as B,l as le,m as ae,k as j,B as Re,x as k,n as re,p as We,C as ie,D as ee,E as ne,F as Oe,G as Ae,H as Ze}from"../chunks/scheduler.42865049.js";import{S as Pe,i as He,f as Ue,b as se,d as fe,m as ce,a as R,c as ke,t as X,e as ue,g as ye}from"../chunks/index.156b26f3.js";import{e as te,M as Fe,r as Je,a as Qe,b as Xe,g as Ye,c as xe,d as ve}from"../chunks/MapTooltip.svelte_svelte_type_style_lang.f15e276a.js";import{b as je,s as et}from"../chunks/utils.9e297d88.js";async function tt({parent:t}){return await t()}const vt=Object.freeze(Object.defineProperty({__proto__:null,load:tt},Symbol.toStringTag,{value:"Module"}));function we(t,e,o){const a=t.slice();return a[16]=e[o],a}function Ce(t,e,o){const a=t.slice();return a[19]=e[o],a[21]=o,a}function Ee(t,e,o){const a=t.slice();return a[19]=e[o],a[21]=o,a}function Se(t,e,o){const a=t.slice();return a[16]=e[o],a[21]=o,a}function De(t){let e,o=te(t[9]),a=[];for(let l=0;l<o.length;l+=1)a[l]=Te(Se(t,o,l));return{c(){e=D("ul");for(let l=0;l<a.length;l+=1)a[l].c();this.h()},l(l){e=T(l,"UL",{class:!0});var i=N(e);for(let n=0;n<a.length;n+=1)a[n].l(i);i.forEach(_),this.h()},h(){B(e,"class","legend-block svelte-v05hvd")},m(l,i){L(l,e,i);for(let n=0;n<a.length;n+=1)a[n]&&a[n].m(e,null)},p(l,i){if(i&576){o=te(l[9]);let n;for(n=0;n<o.length;n+=1){const s=Se(l,o,n);a[n]?a[n].p(s,i):(a[n]=Te(s),a[n].c(),a[n].m(e,null))}for(;n<a.length;n+=1)a[n].d(1);a.length=o.length}},d(l){l&&_(e),me(a,l)}}}function Te(t){let e,o,a,l,i=t[16]+"",n,s;return{c(){e=D("li"),o=D("div"),a=M(),l=D("span"),n=le(i),s=M(),this.h()},l(f){e=T(f,"LI",{class:!0});var g=N(e);o=T(g,"DIV",{class:!0}),N(o).forEach(_),a=V(g),l=T(g,"SPAN",{class:!0});var p=N(l);n=ae(p,i),p.forEach(_),s=V(g),g.forEach(_),this.h()},h(){B(o,"class","legend-vis "+(t[21]==0?"bar":"marker")+" svelte-v05hvd"),j(o,"height","1rem"),j(o,"width",t[21]==0?"1rem":t[6]+"px"),B(l,"class",Re(t[21]==0?"bold":"brackets")+" svelte-v05hvd"),B(e,"class","svelte-v05hvd")},m(f,g){L(f,e,g),k(e,o),k(e,a),k(e,l),k(l,n),k(e,s)},p(f,g){g&64&&j(o,"width",f[21]==0?"1rem":f[6]+"px"),g&512&&i!==(i=f[16]+"")&&re(n,i)},d(f){f&&_(e)}}}function Le(t){let e,o=t[3](t[19][t[0]])+"",a,l;return{c(){e=D("span"),a=le(o),l=le(t[4]),this.h()},l(i){e=T(i,"SPAN",{class:!0});var n=N(e);a=ae(n,o),l=ae(n,t[4]),n.forEach(_),this.h()},h(){B(e,"class","label "+(t[21]==0?"bold":"sml brackets")+" svelte-v05hvd")},m(i,n){L(i,e,n),k(e,a),k(e,l)},p(i,n){n&137&&o!==(o=i[3](i[19][i[0]])+"")&&re(a,o),n&16&&re(l,i[4])},d(i){i&&_(e)}}}function lt(t){let e,o=`calc(${t[8](t[19][t[0]])}% - ${t[6]/2}px)`,a=`${t[6]}px`;return{c(){e=D("div"),this.h()},l(l){e=T(l,"DIV",{class:!0}),N(e).forEach(_),this.h()},h(){B(e,"class","marker svelte-v05hvd"),j(e,"left",o),j(e,"border-left-width",a)},m(l,i){L(l,e,i)},p(l,i){i&449&&o!==(o=`calc(${l[8](l[19][l[0]])}% - ${l[6]/2}px)`)&&j(e,"left",o),i&64&&a!==(a=`${l[6]}px`)&&j(e,"border-left-width",a)},d(l){l&&_(e)}}}function at(t){let e,o=`${t[8](t[19][t[0]])}%`;return{c(){e=D("div"),this.h()},l(a){e=T(a,"DIV",{class:!0}),N(e).forEach(_),this.h()},h(){B(e,"class","bar svelte-v05hvd"),j(e,"left","0"),j(e,"width",o),j(e,"background-color",typeof t[19][t[1]]=="number"?t[2][t[19][t[1]]]:null)},m(a,l){L(a,e,l)},p(a,l){l&385&&o!==(o=`${a[8](a[19][a[0]])}%`)&&j(e,"width",o),l&134&&j(e,"background-color",typeof a[19][a[1]]=="number"?a[2][a[19][a[1]]]:null)},d(a){a&&_(e)}}}function qe(t){let e;function o(i,n){return i[21]==0?at:lt}let l=o(t)(t);return{c(){l.c(),e=he()},l(i){l.l(i),e=he()},m(i,n){l.m(i,n),L(i,e,n)},p(i,n){l.p(i,n)},d(i){i&&_(e),l.d(i)}}}function Be(t){let e,o=t[10](t[16].label)+"",a,l,i,n,s,f=`${t[5]}px`,g=te(t[16].values),p=[];for(let r=0;r<g.length;r+=1)p[r]=Le(Ee(t,g,r));let q=te(t[16].values),d=[];for(let r=0;r<q.length;r+=1)d[r]=qe(Ce(t,q,r));return{c(){e=D("div"),a=le(o),l=M();for(let r=0;r<p.length;r+=1)p[r].c();i=M(),n=D("div");for(let r=0;r<d.length;r+=1)d[r].c();s=M(),this.h()},l(r){e=T(r,"DIV",{class:!0});var h=N(e);a=ae(h,o),l=V(h);for(let E=0;E<p.length;E+=1)p[E].l(h);h.forEach(_),i=V(r),n=T(r,"DIV",{class:!0});var u=N(n);for(let E=0;E<d.length;E+=1)d[E].l(u);s=V(u),u.forEach(_),this.h()},h(){B(e,"class","label-group svelte-v05hvd"),B(n,"class","bar-group svelte-v05hvd"),j(n,"height",f)},m(r,h){L(r,e,h),k(e,a),k(e,l);for(let u=0;u<p.length;u+=1)p[u]&&p[u].m(e,null);L(r,i,h),L(r,n,h);for(let u=0;u<d.length;u+=1)d[u]&&d[u].m(n,null);k(n,s)},p(r,h){if(h&128&&o!==(o=r[10](r[16].label)+"")&&re(a,o),h&153){g=te(r[16].values);let u;for(u=0;u<g.length;u+=1){const E=Ee(r,g,u);p[u]?p[u].p(E,h):(p[u]=Le(E),p[u].c(),p[u].m(e,null))}for(;u<p.length;u+=1)p[u].d(1);p.length=g.length}if(h&455){q=te(r[16].values);let u;for(u=0;u<q.length;u+=1){const E=Ce(r,q,u);d[u]?d[u].p(E,h):(d[u]=qe(E),d[u].c(),d[u].m(n,s))}for(;u<d.length;u+=1)d[u].d(1);d.length=q.length}h&32&&f!==(f=`${r[5]}px`)&&j(n,"height",f)},d(r){r&&(_(e),_(i),_(n)),me(p,r),me(d,r)}}}function nt(t){let e,o,a=t[9][1]&&De(t),l=te(t[7]),i=[];for(let n=0;n<l.length;n+=1)i[n]=Be(we(t,l,n));return{c(){a&&a.c(),e=M();for(let n=0;n<i.length;n+=1)i[n].c();o=he()},l(n){a&&a.l(n),e=V(n);for(let s=0;s<i.length;s+=1)i[s].l(n);o=he()},m(n,s){a&&a.m(n,s),L(n,e,s);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(n,s);L(n,o,s)},p(n,[s]){if(n[9][1]?a?a.p(n,s):(a=De(n),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),s&1535){l=te(n[7]);let f;for(f=0;f<l.length;f+=1){const g=we(n,l,f);i[f]?i[f].p(g,s):(i[f]=Be(g),i[f].c(),i[f].m(o.parentNode,o))}for(;f<i.length;f+=1)i[f].d(1);i.length=l.length}},i:be,o:be,d(n){n&&(_(e),_(o)),a&&a.d(n),me(i,n)}}}function ot(t,e,o){let a,l,i,n,{data:s}=e,{xKey:f="value"}=e,{yKey:g="category"}=e,{zKey:p="group"}=e,{colorKey:q="color"}=e,{colors:d=["white","#888","#444"]}=e,{formatTick:r=m=>m.toLocaleString()}=e,{suffix:h=""}=e,{barHeight:u=20}=e,{markerWidth:E=3}=e;function K(m,z){let A={};for(const C of m)A[C[z]]||(A[C[z]]={label:C[z],values:[]}),A[C[z]].values.push(C);let P=[];for(const C in A)P.push(A[C]);return P}const G=m=>m.charAt(0).toUpperCase()+m.slice(1);return t.$$set=m=>{"data"in m&&o(11,s=m.data),"xKey"in m&&o(0,f=m.xKey),"yKey"in m&&o(12,g=m.yKey),"zKey"in m&&o(13,p=m.zKey),"colorKey"in m&&o(1,q=m.colorKey),"colors"in m&&o(2,d=m.colors),"formatTick"in m&&o(3,r=m.formatTick),"suffix"in m&&o(4,h=m.suffix),"barHeight"in m&&o(5,u=m.barHeight),"markerWidth"in m&&o(6,E=m.markerWidth)},t.$$.update=()=>{t.$$.dirty&2049&&o(14,a=[0,Math.max(...s.map(m=>m[f]))]),t.$$.dirty&10240&&o(9,l=s.map(m=>m[p]).filter((m,z,A)=>A.indexOf(m)===z)),t.$$.dirty&16384&&o(8,i=m=>m/a[1]*100),t.$$.dirty&6144&&o(7,n=K(s,g))},[f,q,d,r,h,u,E,n,i,l,G,s,g,p,a]}class Ge extends Pe{constructor(e){super(),He(this,e,ot,nt,ze,{data:11,xKey:0,yKey:12,zKey:13,colorKey:1,colors:2,formatTick:3,suffix:4,barHeight:5,markerWidth:6})}}function Ie(t,e,o){const a=t.slice();return a[41]=e[o],a}function $e(t,e,o){const a=t.slice();return a[44]=e[o],a}function Me(t){let e,o="Deselect",a,l;return{c(){e=D("button"),e.textContent=o,this.h()},l(i){e=T(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ie(e)!=="svelte-xhbl9c"&&(e.textContent=o),this.h()},h(){B(e,"class","btn-link svelte-1egxxhq")},m(i,n){L(i,e,n),a||(l=ne(e,"click",t[13]),a=!0)},p:be,d(i){i&&_(e),a=!1,l()}}}function it(t){let e,o;function a(...l){return t[23](t[44],...l)}return e=new Ge({props:{data:[{category:"Works from home",value:t[8][t[44]].home,color:0},{category:`Lives within ${t[9][t[44]].areanm}`,value:t[8][t[44]].within,color:0},...[1,2,3,4,5].map(a),{category:"Lives in another location",value:t[8][t[44]].fromother,color:2}]}}),{c(){se(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,i){ce(e,l,i),o=!0},p(l,i){t=l;const n={};i[0]&6&&(n.data=[{category:"Works from home",value:t[8][t[44]].home,color:0},{category:`Lives within ${t[9][t[44]].areanm}`,value:t[8][t[44]].within,color:0},...[1,2,3,4,5].map(a),{category:"Lives in another location",value:t[8][t[44]].fromother,color:2}]),e.$set(n)},i(l){o||(R(e.$$.fragment,l),o=!0)},o(l){X(e.$$.fragment,l),o=!1},d(l){ue(e,l)}}}function rt(t){let e,o;function a(...l){return t[22](t[44],...l)}return e=new Ge({props:{data:[{category:"Works from home",value:t[8][t[44]].home,color:0},{category:`Works within ${t[9][t[44]].areanm}`,value:t[8][t[44]].within,color:0},...[1,2,3,4,5].map(a),{category:"Works in another location",value:t[8][t[44]].toother,color:2}]}}),{c(){se(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,i){ce(e,l,i),o=!0},p(l,i){t=l;const n={};i[0]&6&&(n.data=[{category:"Works from home",value:t[8][t[44]].home,color:0},{category:`Works within ${t[9][t[44]].areanm}`,value:t[8][t[44]].within,color:0},...[1,2,3,4,5].map(a),{category:"Works in another location",value:t[8][t[44]].toother,color:2}]),e.$set(n)},i(l){o||(R(e.$$.fragment,l),o=!0)},o(l){X(e.$$.fragment,l),o=!1},d(l){ue(e,l)}}}function Ve(t){let e,o=t[9][t[44]].areanm+"",a,l,i,n,s,f,g=t[8][t[44]].resident.toLocaleString()+"",p,q,d,r,h,u=t[8][t[44]].workday.toLocaleString()+"",E,K,G,m=(t[8][t[44]].workday-t[8][t[44]].resident).toLocaleString("en-GB",{signDisplay:"exceptZero"})+"",z,A,P,C,W,Q,Y,x,H,S,Z,$,de,O=t[44]===t[1]&&Me(t);const v=[rt,it],y=[];function F(c,w){return c[6]==="from"?0:1}return C=F(t),W=y[C]=v[C](t),{c(){e=D("div"),a=le(o),l=M(),O&&O.c(),i=M(),n=D("button"),s=le(`Resident population
				`),f=D("div"),p=le(g),q=M(),d=D("button"),r=le(`Workday population
				`),h=D("div"),E=le(u),K=M(),G=D("div"),z=le(m),A=M(),P=D("div"),W.c(),Q=M(),Y=D("div"),x=D("label"),H=D("input"),S=le(`
					Highlight points for this area on map`),this.h()},l(c){e=T(c,"DIV",{class:!0});var w=N(e);a=ae(w,o),l=V(w),O&&O.l(w),w.forEach(_),i=V(c),n=T(c,"BUTTON",{class:!0});var J=N(n);s=ae(J,`Resident population
				`),f=T(J,"DIV",{class:!0});var oe=N(f);p=ae(oe,g),oe.forEach(_),J.forEach(_),q=V(c),d=T(c,"BUTTON",{class:!0});var _e=N(d);r=ae(_e,`Workday population
				`),h=T(_e,"DIV",{class:!0});var pe=N(h);E=ae(pe,u),pe.forEach(_),K=V(_e),G=T(_e,"DIV",{class:!0});var ge=N(G);z=ae(ge,m),ge.forEach(_),_e.forEach(_),A=V(c),P=T(c,"DIV",{});var b=N(P);W.l(b),b.forEach(_),Q=V(c),Y=T(c,"DIV",{});var I=N(Y);x=T(I,"LABEL",{});var U=N(x);H=T(U,"INPUT",{type:!0}),S=ae(U,`
					Highlight points for this area on map`),U.forEach(_),I.forEach(_),this.h()},h(){B(e,"class","big-text svelte-1egxxhq"),j(e,"grid-column","span 2"),B(f,"class","big-text svelte-1egxxhq"),B(n,"class","svelte-1egxxhq"),ee(n,"btn-active",t[6]==="from"),B(h,"class","big-text svelte-1egxxhq"),B(G,"class","small-text svelte-1egxxhq"),B(d,"class","svelte-1egxxhq"),ee(d,"btn-active",t[6]==="to"),j(P,"grid-column","span 2"),B(H,"type","checkbox"),j(Y,"grid-column","span 2")},m(c,w){L(c,e,w),k(e,a),k(e,l),O&&O.m(e,null),L(c,i,w),L(c,n,w),k(n,s),k(n,f),k(f,p),L(c,q,w),L(c,d,w),k(d,r),k(d,h),k(h,E),k(d,K),k(d,G),k(G,z),L(c,A,w),L(c,P,w),y[C].m(P,null),L(c,Q,w),L(c,Y,w),k(Y,x),k(x,H),H.checked=t[7],k(x,S),Z=!0,$||(de=[ne(n,"click",t[20]),ne(d,"click",t[21]),ne(H,"change",t[24]),ne(H,"change",t[25])],$=!0)},p(c,w){(!Z||w[0]&6)&&o!==(o=c[9][c[44]].areanm+"")&&re(a,o),c[44]===c[1]?O?O.p(c,w):(O=Me(c),O.c(),O.m(e,null)):O&&(O.d(1),O=null),(!Z||w[0]&6)&&g!==(g=c[8][c[44]].resident.toLocaleString()+"")&&re(p,g),(!Z||w[0]&64)&&ee(n,"btn-active",c[6]==="from"),(!Z||w[0]&6)&&u!==(u=c[8][c[44]].workday.toLocaleString()+"")&&re(E,u),(!Z||w[0]&6)&&m!==(m=(c[8][c[44]].workday-c[8][c[44]].resident).toLocaleString("en-GB",{signDisplay:"exceptZero"})+"")&&re(z,m),(!Z||w[0]&64)&&ee(d,"btn-active",c[6]==="to");let J=C;C=F(c),C===J?y[C].p(c,w):(ye(),X(y[J],1,1,()=>{y[J]=null}),ke(),W=y[C],W?W.p(c,w):(W=y[C]=v[C](c),W.c()),R(W,1),W.m(P,null)),w[0]&128&&(H.checked=c[7])},i(c){Z||(R(W),Z=!0)},o(c){X(W),Z=!1},d(c){c&&(_(e),_(i),_(n),_(q),_(d),_(A),_(P),_(Q),_(Y)),O&&O.d(),y[C].d(),$=!1,Ae(de)}}}function Ne(t){let e,o="2011 Census travel to work data",a,l,i="<p>Using this experimental tool, you can:</p> <ul><li>animate commutes on a map, by clicking &quot;place of work&quot;.</li> <li>see commutes for individual area, by hovering or clicking an area on the map.</li></ul> <p>Note: The data in this tool is from 2011, not the latest 2021 census.</p>";return{c(){e=D("div"),e.textContent=o,a=M(),l=D("div"),l.innerHTML=i,this.h()},l(n){e=T(n,"DIV",{class:!0,"data-svelte-h":!0}),ie(e)!=="svelte-wjk7dk"&&(e.textContent=o),a=V(n),l=T(n,"DIV",{"data-svelte-h":!0}),ie(l)!=="svelte-sjb3fc"&&(l.innerHTML=i),this.h()},h(){B(e,"class","big-text svelte-1egxxhq"),j(e,"grid-column","span 2"),j(l,"grid-column","span 2")},m(n,s){L(n,e,s),L(n,a,s),L(n,l,s)},d(n){n&&(_(e),_(a),_(l))}}}function st(t){let e,o,a=te(t[10]),l=[];for(let n=0;n<a.length;n+=1)l[n]=Ke(Ie(t,a,n));const i=n=>X(l[n],1,1,()=>{l[n]=null});return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=he()},l(n){for(let s=0;s<l.length;s+=1)l[s].l(n);e=he()},m(n,s){for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(n,s);L(n,e,s),o=!0},p(n,s){if(s[0]&5150){a=te(n[10]);let f;for(f=0;f<a.length;f+=1){const g=Ie(n,a,f);l[f]?(l[f].p(g,s),R(l[f],1)):(l[f]=Ke(g),l[f].c(),R(l[f],1),l[f].m(e.parentNode,e))}for(ye(),f=a.length;f<l.length;f+=1)i(f);ke()}},i(n){if(!o){for(let s=0;s<a.length;s+=1)R(l[s]);o=!0}},o(n){l=l.filter(Boolean);for(let s=0;s<l.length;s+=1)X(l[s]);o=!1},d(n){n&&_(e),me(l,n)}}}function ft(t){let e,o,a,l,i,n,s,f,g,p;function q(r){t[28](r)}let d={id:t[41].key+"-fill",type:"fill",paint:{"fill-color":"rgba(0,0,0,0)"},order:"water",hover:!0,select:!0,selected:t[1],highlight:!0,highlighted:t[3],visible:t[4]===t[41].key};return t[2]!==void 0&&(d.hovered=t[2]),e=new ve({props:d}),We.push(()=>Ue(e,"hovered",q)),e.$on("select",t[12]),l=new ve({props:{id:t[41].key+"-line",type:"line",paint:{"line-color":"#555","line-width":.5},order:"place_other",visible:t[4]===t[41].key}}),n=new ve({props:{id:t[41].key+"-highlighted",type:"line",paint:{"line-color":["case",["==",["feature-state","highlighted"],!0],"#aaa","rgba(0,0,0,0)"],"line-width":1},order:"place_other",visible:t[4]===t[41].key}}),f=new ve({props:{id:t[41].key+"-selected",type:"line",paint:{"line-color":["case",["==",["feature-state","selected"],!0],"white",["==",["feature-state","hovered"],!0],"white","rgba(0,0,0,0)"],"line-width":["case",["==",["feature-state","selected"],!0],2.5,1]},order:"place_other",visible:t[4]===t[41].key}}),{c(){se(e.$$.fragment),a=M(),se(l.$$.fragment),i=M(),se(n.$$.fragment),s=M(),se(f.$$.fragment),g=M()},l(r){fe(e.$$.fragment,r),a=V(r),fe(l.$$.fragment,r),i=V(r),fe(n.$$.fragment,r),s=V(r),fe(f.$$.fragment,r),g=V(r)},m(r,h){ce(e,r,h),L(r,a,h),ce(l,r,h),L(r,i,h),ce(n,r,h),L(r,s,h),ce(f,r,h),L(r,g,h),p=!0},p(r,h){const u={};h[0]&2&&(u.selected=r[1]),h[0]&8&&(u.highlighted=r[3]),h[0]&16&&(u.visible=r[4]===r[41].key),!o&&h[0]&4&&(o=!0,u.hovered=r[2],Oe(()=>o=!1)),e.$set(u);const E={};h[0]&16&&(E.visible=r[4]===r[41].key),l.$set(E);const K={};h[0]&16&&(K.visible=r[4]===r[41].key),n.$set(K);const G={};h[0]&16&&(G.visible=r[4]===r[41].key),f.$set(G)},i(r){p||(R(e.$$.fragment,r),R(l.$$.fragment,r),R(n.$$.fragment,r),R(f.$$.fragment,r),p=!0)},o(r){X(e.$$.fragment,r),X(l.$$.fragment,r),X(n.$$.fragment,r),X(f.$$.fragment,r),p=!1},d(r){r&&(_(a),_(i),_(s),_(g)),ue(e,r),ue(l,r),ue(n,r),ue(f,r)}}}function Ke(t){let e,o;const a=[{id:t[41].key},{type:t[41].type},{promoteId:"areacd"},t[41].props];let l={$$slots:{default:[ft]},$$scope:{ctx:t}};for(let i=0;i<a.length;i+=1)l=Ze(l,a[i]);return e=new Xe({props:l}),{c(){se(e.$$.fragment)},l(i){fe(e.$$.fragment,i)},m(i,n){ce(e,i,n),o=!0},p(i,n){const s=n[0]&1024?Ye(a,[{id:i[41].key},{type:i[41].type},a[2],xe(i[41].props)]):{};n[0]&30|n[1]&65536&&(s.$$scope={dirty:n,ctx:i}),e.$set(s)},i(i){o||(R(e.$$.fragment,i),o=!0)},o(i){X(e.$$.fragment,i),o=!1},d(i){ue(e,i)}}}function ct(t){let e,o,a=t[10][1].props.data&&st(t);return{c(){a&&a.c(),e=he()},l(l){a&&a.l(l),e=he()},m(l,i){a&&a.m(l,i),L(l,e,i),o=!0},p(l,i){l[10][1].props.data&&a.p(l,i)},i(l){o||(R(a),o=!0)},o(l){X(a),o=!1},d(l){l&&_(e),a&&a.d(l)}}}function ut(t){let e,o,a,l,i="Local authorities",n,s,f="Neighbourhoods",g,p,q,d,r,h,u="Place of residence",E,K,G="Place of work",m,z,A="1 dot = 100 working people",P,C,W,Q,Y,x,H=te(t[2]?[t[2]]:t[1]?[t[1]]:[]),S=[];for(let v=0;v<H.length;v+=1)S[v]=Ve($e(t,H,v));const Z=v=>X(S[v],1,1,()=>{S[v]=null});let $=!t[1]&&!t[2]&&Ne();function de(v){t[29](v)}let O={style:"https://bothness.github.io/ons-basemaps/data/style-dark.json",location:{bounds:je.ew},options:{antialias:!0},minzoom:6,controls:!0,$$slots:{default:[ct]},$$scope:{ctx:t}};return t[0]!==void 0&&(O.map=t[0]),C=new Fe({props:O}),We.push(()=>Ue(C,"map",de)),C.$on("load",t[11]),{c(){e=D("main"),o=D("div"),a=D("div"),l=D("button"),l.textContent=i,n=M(),s=D("button"),s.textContent=f,g=M();for(let v=0;v<S.length;v+=1)S[v].c();p=M(),$&&$.c(),q=M(),d=D("div"),r=D("div"),h=D("button"),h.textContent=u,E=M(),K=D("button"),K.textContent=G,m=M(),z=D("span"),z.textContent=A,P=M(),se(C.$$.fragment),this.h()},l(v){e=T(v,"MAIN",{class:!0});var y=N(e);o=T(y,"DIV",{class:!0});var F=N(o);a=T(F,"DIV",{class:!0});var c=N(a);l=T(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ie(l)!=="svelte-lrx6fl"&&(l.textContent=i),n=V(c),s=T(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ie(s)!=="svelte-1k1320n"&&(s.textContent=f),g=V(c);for(let oe=0;oe<S.length;oe+=1)S[oe].l(c);p=V(c),$&&$.l(c),c.forEach(_),F.forEach(_),q=V(y),d=T(y,"DIV",{class:!0});var w=N(d);r=T(w,"DIV",{class:!0});var J=N(r);h=T(J,"BUTTON",{class:!0,"data-svelte-h":!0}),ie(h)!=="svelte-y002uz"&&(h.textContent=u),E=V(J),K=T(J,"BUTTON",{class:!0,"data-svelte-h":!0}),ie(K)!=="svelte-10os208"&&(K.textContent=G),m=V(J),z=T(J,"SPAN",{class:!0,"data-svelte-h":!0}),ie(z)!=="svelte-fy5vjs"&&(z.textContent=A),J.forEach(_),P=V(w),fe(C.$$.fragment,w),w.forEach(_),y.forEach(_),this.h()},h(){B(l,"class","svelte-1egxxhq"),ee(l,"btn-active",t[4]==="lad"),B(s,"class","svelte-1egxxhq"),ee(s,"btn-active",t[4]==="msoa"),B(a,"class","grid svelte-1egxxhq"),B(o,"class","info svelte-1egxxhq"),B(h,"class","svelte-1egxxhq"),ee(h,"btn-active",t[5]==="from"),B(K,"class","svelte-1egxxhq"),ee(K,"btn-active",t[5]==="to"),B(z,"class","svelte-1egxxhq"),B(r,"class","map-legend svelte-1egxxhq"),B(d,"class","map svelte-1egxxhq"),B(e,"class","container svelte-1egxxhq")},m(v,y){L(v,e,y),k(e,o),k(o,a),k(a,l),k(a,n),k(a,s),k(a,g);for(let F=0;F<S.length;F+=1)S[F]&&S[F].m(a,null);k(a,p),$&&$.m(a,null),k(e,q),k(e,d),k(d,r),k(r,h),k(r,E),k(r,K),k(r,m),k(r,z),k(d,P),ce(C,d,null),Q=!0,Y||(x=[ne(l,"click",t[18]),ne(s,"click",t[19]),ne(h,"click",t[26]),ne(K,"click",t[27])],Y=!0)},p(v,y){if((!Q||y[0]&16)&&ee(l,"btn-active",v[4]==="lad"),(!Q||y[0]&16)&&ee(s,"btn-active",v[4]==="msoa"),y[0]&74694){H=te(v[2]?[v[2]]:v[1]?[v[1]]:[]);let c;for(c=0;c<H.length;c+=1){const w=$e(v,H,c);S[c]?(S[c].p(w,y),R(S[c],1)):(S[c]=Ve(w),S[c].c(),R(S[c],1),S[c].m(a,p))}for(ye(),c=H.length;c<S.length;c+=1)Z(c);ke()}!v[1]&&!v[2]?$||($=Ne(),$.c(),$.m(a,null)):$&&($.d(1),$=null),(!Q||y[0]&32)&&ee(h,"btn-active",v[5]==="from"),(!Q||y[0]&32)&&ee(K,"btn-active",v[5]==="to");const F={};y[0]&30|y[1]&65536&&(F.$$scope={dirty:y,ctx:v}),!W&&y[0]&1&&(W=!0,F.map=v[0],Oe(()=>W=!1)),C.$set(F)},i(v){if(!Q){for(let y=0;y<H.length;y+=1)R(S[y]);R(C.$$.fragment,v),Q=!0}},o(v){S=S.filter(Boolean);for(let y=0;y<S.length;y+=1)X(S[y]);X(C.$$.fragment,v),Q=!1},d(v){v&&_(e),me(S,v),$&&$.d(),ue(C),Y=!1,Ae(x)}}}function ht(t,e,o){return[1,2,3,4,5].map(a=>t[e][`${o==="to"?"from":"to"}${a}cd`])}function _t(t,e,o){let{data:a}=e;const{areadata:l,metadata:i,sources:n,points:s}=a,f=s.array.length,g=et([5,14],[.5,4]);let p,q,d,r,h,u,E,K,G,m,z,A="lad",P="from",C="from",W=!0;function Q(b){const I=[Math.min(...b.map(U=>U.xmin)),Math.min(...b.map(U=>U.ymin)),Math.max(...b.map(U=>U.xmax)),Math.max(...b.map(U=>U.ymax))];p.fitBounds(I,{padding:50})}async function Y(){const b=I=>(u=Je(I),E=Qe(u),G=E.buffer(s.from,{duration:5e3,ease:"linear"}),m=u.buffer(Array.from({length:f},()=>.7)),{render:E({vert:`
      uniform mat4 uMatrix;
      uniform float pointSize;
      precision lowp float;
      attribute vec2 position;
			attribute float opacity;
			varying float fragOpacity;

      void main() {
        gl_PointSize = pointSize;
        gl_Position = uMatrix * vec4(position, 0, 1);
				fragOpacity = opacity;
      }
        `,frag:`
      precision lowp float;
			varying float fragOpacity;

      void main() {
        if (length(gl_PointCoord.xy - 0.5) > 0.5) {
          discard;
        }
        gl_FragColor = vec4(0.145, 0.627, 0.8, fragOpacity);
      }
      `,attributes:{position:G,opacity:m},uniforms:{pointSize:u.prop("pointSize")||2,uMatrix:u.prop("uMatrix")},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},depth:{enable:!1},count:f,primitive:"points"})});p.addLayer({id:"custom_layer",type:"custom",onAdd:(I,U)=>{K=b(U),u.frame(()=>{I&&h&&I.triggerRepaint()})},render(I,U){z=U,h=p.getZoom(),K.render({uMatrix:z,pointSize:g(h)*window.devicePixelRatio})}},"place_suburb")}function x(b){var U;const I=typeof b=="string"?b:(U=b==null?void 0:b.detail)==null?void 0:U.id;I&&(o(1,q=I),$())}function H(b){o(1,q=null),o(3,r=[]),m({data:Array.from({length:s.array.length},()=>.7)}),b&&p.fitBounds(je.ew)}function S(b,I){P!==b&&(G.update(s[b],I?{duration:I}:null),o(5,P=b))}function Z(b){A!==b&&(o(4,A=b),q&&b==="lad"?x(i[q].parentcd):H())}function $(b=C){q&&(m({data:W?s.array.map(I=>I[`${b}_${A}`]===q?1:.1):Array.from({length:s.array.length},()=>.7)}),o(3,r=ht(l,q,b)),o(6,C=b),Q([i[q],...r.map(I=>i[I])]))}const de=()=>Z("lad"),O=()=>Z("msoa"),v=()=>$("from"),y=()=>$("to"),F=(b,I)=>({category:`Works in ${i[l[b][`to${I}cd`]].areanm}`,value:l[b][`to${I}`],color:1}),c=(b,I)=>({category:`Lives in ${i[l[b][`from${I}cd`]].areanm}`,value:l[b][`from${I}`],color:1});function w(){W=this.checked,o(7,W)}const J=()=>$(),oe=()=>S("from"),_e=()=>S("to");function pe(b){d=b,o(2,d)}function ge(b){p=b,o(0,p)}return t.$$set=b=>{"data"in b&&o(17,a=b.data)},[p,q,d,r,A,P,C,W,l,i,n,Y,x,H,S,Z,$,a,de,O,v,y,F,c,w,J,oe,_e,pe,ge]}class bt extends Pe{constructor(e){super(),He(this,e,_t,ut,ze,{data:17},null,[-1,-1])}}export{bt as component,vt as universal};
