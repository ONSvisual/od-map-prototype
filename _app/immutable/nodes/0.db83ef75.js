//js
import{b as _}from"../chunks/paths.b150c641.js";import{m as j,c as y,a as v,p as b}from"../chunks/utils.368c67f1.js";import{s as P,r as C,u as k,v as q,w as F}from"../chunks/scheduler.3a2f20bc.js";import{S as M,i as O,a as G,t as L}from"../chunks/index.b332e88e.js";function E(t){return t}function J(t){if(t==null)return E;var e,i,r=t.scale[0],a=t.scale[1],l=t.translate[0],f=t.translate[1];return function(p,d){d||(e=i=0);var u=2,o=p.length,s=new Array(o);for(s[0]=(e+=p[0])*r+l,s[1]=(i+=p[1])*a+f;u<o;)s[u]=p[u],++u;return s}}function N(t,e){for(var i,r=t.length,a=r-e;a<--r;)i=t[a],t[a++]=t[r],t[r]=i}function T(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(i){return $(t,i)})}:$(t,e)}function $(t,e){var i=e.id,r=e.bbox,a=e.properties==null?{}:e.properties,l=z(t,e);return i==null&&r==null?{type:"Feature",properties:a,geometry:l}:r==null?{type:"Feature",id:i,properties:a,geometry:l}:{type:"Feature",id:i,bbox:r,properties:a,geometry:l}}function z(t,e){var i=J(t.transform),r=t.arcs;function a(o,s){s.length&&s.pop();for(var c=r[o<0?~o:o],m=0,g=c.length;m<g;++m)s.push(i(c[m],m));o<0&&N(s,g)}function l(o){return i(o)}function f(o){for(var s=[],c=0,m=o.length;c<m;++c)a(o[c],s);return s.length<2&&s.push(s[0]),s}function p(o){for(var s=f(o);s.length<4;)s.push(s[0]);return s}function d(o){return o.map(p)}function u(o){var s=o.type,c;switch(s){case"GeometryCollection":return{type:s,geometries:o.geometries.map(u)};case"Point":c=l(o.coordinates);break;case"MultiPoint":c=o.coordinates.map(l);break;case"LineString":c=f(o.arcs);break;case"MultiLineString":c=o.arcs.map(f);break;case"Polygon":c=d(o.arcs);break;case"MultiPolygon":c=o.arcs.map(d);break;default:return null}return{type:s,coordinates:c}}return u(e)}const A=!0,B="always";async function D({fetch:t}){let e=JSON.parse(JSON.stringify(j)),i,r,a={};const l=T(await(await t(`${_}/data/lad11_bsc.json`)).json(),"lad"),f=await(await t(`${_}/data/lad11_metadata.csv`)).text(),p=await(await t(`${_}/data/msoa11_metadata.csv`)).text(),d=[...y(await f,v),...y(await p,v)].map(n=>({...n,x:(n.xmin+n.xmax)/2,y:(n.ymin+n.ymax)/2})).sort((n,w)=>n.areanm.localeCompare(w.areanm)),u={};d.forEach(n=>u[n.areacd]=n),r=u,e[1].props.data=l;const o=await t(`${_}/data/lad11_data.csv`),s=await t(`${_}/data/msoa11_data.csv`),c=[...y(await o.text(),v),...y(await s.text(),v)],m={};c.forEach(n=>m[n.areacd]=n),i=m;const g=await t(`${_}/data/msoa11_points.csv`);a.array=y(await g.text(),n=>{var w,x;return{from_msoa:n.from,from_lad:((w=r[n.from])==null?void 0:w.parentcd)||n.from,to_msoa:n.to,to_lad:((x=r[n.to])==null?void 0:x.parentcd)||n.to,x1:+n.x1,y1:+n.y1,x2:+n.x2,y2:+n.y2}}),a.from=a.array.map(n=>b([n.x1,n.y1])),a.to=a.array.map(n=>b([n.x2,n.y2]));const h=await t(`${_}/data/quads.csv`),S={type:"GeometryCollection",geometries:y(await h.text(),n=>({type:"Point",coordinates:[+n.lng,+n.lat]}))};return{arealist:d,areadata:i,metadata:r,sources:e,points:a,quads:S}}const V=Object.freeze(Object.defineProperty({__proto__:null,load:D,prerender:A,trailingSlash:B},Symbol.toStringTag,{value:"Module"}));function H(t){let e;const i=t[1].default,r=C(i,t,t[0],null);return{c(){r&&r.c()},l(a){r&&r.l(a)},m(a,l){r&&r.m(a,l),e=!0},p(a,[l]){r&&r.p&&(!e||l&1)&&k(r,i,a,a[0],e?F(i,a[0],l,null):q(a[0]),null)},i(a){e||(G(r,a),e=!0)},o(a){L(r,a),e=!1},d(a){r&&r.d(a)}}}function I(t,e,i){let{$$slots:r={},$$scope:a}=e;return t.$$set=l=>{"$$scope"in l&&i(0,a=l.$$scope)},[a,r]}class W extends M{constructor(e){super(),O(this,e,I,H,P,{})}}export{W as component,V as universal};
