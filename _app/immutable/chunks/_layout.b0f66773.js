//js
import{b as f}from"./paths.a9807ddd.js";import{m as j,c as _,a as x,p as v}from"./utils.e78e8001.js";function S(a){return a}function P(a){if(a==null)return S;var n,s,i=a.scale[0],o=a.scale[1],l=a.translate[0],d=a.translate[1];return function(m,y){y||(n=s=0);var u=2,t=m.length,e=new Array(t);for(e[0]=(n+=m[0])*i+l,e[1]=(s+=m[1])*o+d;u<t;)e[u]=m[u],++u;return e}}function $(a,n){for(var s,i=a.length,o=i-n;o<--i;)s=a[o],a[o++]=a[i],a[i]=s}function k(a,n){return typeof n=="string"&&(n=a.objects[n]),n.type==="GeometryCollection"?{type:"FeatureCollection",features:n.geometries.map(function(s){return h(a,s)})}:h(a,n)}function h(a,n){var s=n.id,i=n.bbox,o=n.properties==null?{}:n.properties,l=C(a,n);return s==null&&i==null?{type:"Feature",properties:o,geometry:l}:i==null?{type:"Feature",id:s,properties:o,geometry:l}:{type:"Feature",id:s,bbox:i,properties:o,geometry:l}}function C(a,n){var s=P(a.transform),i=a.arcs;function o(t,e){e.length&&e.pop();for(var c=i[t<0?~t:t],p=0,w=c.length;p<w;++p)e.push(s(c[p],p));t<0&&$(e,w)}function l(t){return s(t)}function d(t){for(var e=[],c=0,p=t.length;c<p;++c)o(t[c],e);return e.length<2&&e.push(e[0]),e}function m(t){for(var e=d(t);e.length<4;)e.push(e[0]);return e}function y(t){return t.map(m)}function u(t){var e=t.type,c;switch(e){case"GeometryCollection":return{type:e,geometries:t.geometries.map(u)};case"Point":c=l(t.coordinates);break;case"MultiPoint":c=t.coordinates.map(l);break;case"LineString":c=d(t.arcs);break;case"MultiLineString":c=t.arcs.map(d);break;case"Polygon":c=y(t.arcs);break;case"MultiPolygon":c=t.arcs.map(y);break;default:return null}return{type:e,coordinates:c}}return u(n)}const F=!0,M="always";async function O({fetch:a}){let n=JSON.parse(JSON.stringify(j)),s,i,o={};const l=k(await(await a(`${f}/data/lad11_bsc.json`)).json(),"lad"),d=await(await a(`${f}/data/lad11_metadata.csv`)).text(),m=await(await a(`${f}/data/msoa11_metadata.csv`)).text(),y=[..._(await d),..._(await m)].sort((r,g)=>r.areanm.localeCompare(g.areanm)),u={};y.forEach(r=>u[r.areacd]=r),i=u,n[1].props.data=l;const t=await a(`${f}/data/lad11_data.csv`),e=await a(`${f}/data/msoa11_data.csv`),c=[..._(await t.text(),x),..._(await e.text(),x)],p={};c.forEach(r=>p[r.areacd]=r),s=p;const w=await a(`${f}/data/msoa11_points.csv`);return o.array=_(await w.text(),r=>{var g,b;return{from_msoa:r.from,from_lad:((g=i[r.from])==null?void 0:g.parentcd)||r.from,to_msoa:r.to,to_lad:((b=i[r.to])==null?void 0:b.parentcd)||r.to,x1:+r.x1,y1:+r.y1,x2:+r.x2,y2:+r.y2}}),o.from=o.array.map(r=>v([r.x1,r.y1])),o.to=o.array.map(r=>v([r.x2,r.y2])),{arealist:y,areadata:s,metadata:i,sources:n,points:o}}const J=Object.freeze(Object.defineProperty({__proto__:null,load:O,prerender:F,trailingSlash:M},Symbol.toStringTag,{value:"Module"}));export{J as _,O as l,F as p,M as t};
