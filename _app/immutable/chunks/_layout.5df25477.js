//js
import{b as f}from"./paths.c0f700f5.js";import{m as j,c as _,a as x,p as v}from"./utils.eb6832fa.js";function S(a){return a}function P(a){if(a==null)return S;var r,s,i=a.scale[0],o=a.scale[1],l=a.translate[0],d=a.translate[1];return function(m,y){y||(r=s=0);var u=2,t=m.length,e=new Array(t);for(e[0]=(r+=m[0])*i+l,e[1]=(s+=m[1])*o+d;u<t;)e[u]=m[u],++u;return e}}function $(a,r){for(var s,i=a.length,o=i-r;o<--i;)s=a[o],a[o++]=a[i],a[i]=s}function k(a,r){return typeof r=="string"&&(r=a.objects[r]),r.type==="GeometryCollection"?{type:"FeatureCollection",features:r.geometries.map(function(s){return h(a,s)})}:h(a,r)}function h(a,r){var s=r.id,i=r.bbox,o=r.properties==null?{}:r.properties,l=F(a,r);return s==null&&i==null?{type:"Feature",properties:o,geometry:l}:i==null?{type:"Feature",id:s,properties:o,geometry:l}:{type:"Feature",id:s,bbox:i,properties:o,geometry:l}}function F(a,r){var s=P(a.transform),i=a.arcs;function o(t,e){e.length&&e.pop();for(var c=i[t<0?~t:t],p=0,w=c.length;p<w;++p)e.push(s(c[p],p));t<0&&$(e,w)}function l(t){return s(t)}function d(t){for(var e=[],c=0,p=t.length;c<p;++c)o(t[c],e);return e.length<2&&e.push(e[0]),e}function m(t){for(var e=d(t);e.length<4;)e.push(e[0]);return e}function y(t){return t.map(m)}function u(t){var e=t.type,c;switch(e){case"GeometryCollection":return{type:e,geometries:t.geometries.map(u)};case"Point":c=l(t.coordinates);break;case"MultiPoint":c=t.coordinates.map(l);break;case"LineString":c=d(t.arcs);break;case"MultiLineString":c=t.arcs.map(d);break;case"Polygon":c=y(t.arcs);break;case"MultiPolygon":c=t.arcs.map(y);break;default:return null}return{type:e,coordinates:c}}return u(r)}const M=!0,O="always";async function C({fetch:a}){let r=JSON.parse(JSON.stringify(j)),s,i,o={};const l=k(await(await a(`${f}/data/lad11_bsc.json`)).json(),"lad"),d=await(await a(`${f}/data/lad11_metadata.csv`)).text(),m=await(await a(`${f}/data/msoa11_metadata.csv`)).text(),y=[..._(await d),..._(await m)],u={};y.forEach(n=>u[n.areacd]=n),i=u,r[1].props.data=l;const t=await a(`${f}/data/lad11_data.csv`),e=await a(`${f}/data/msoa11_data.csv`),c=[..._(await t.text(),x),..._(await e.text(),x)],p={};c.forEach(n=>p[n.areacd]=n),s=p;const w=await a(`${f}/data/msoa11_points.csv`);return o.array=_(await w.text(),n=>{var g,b;return{from_msoa:n.from,from_lad:((g=i[n.from])==null?void 0:g.parentcd)||n.from,to_msoa:n.to,to_lad:((b=i[n.to])==null?void 0:b.parentcd)||n.to,x1:+n.x1,y1:+n.y1,x2:+n.x2,y2:+n.y2}}),o.from=o.array.map(n=>v([n.x1,n.y1])),o.to=o.array.map(n=>v([n.x2,n.y2])),{areadata:s,metadata:i,sources:r,points:o}}const J=Object.freeze(Object.defineProperty({__proto__:null,load:C,prerender:M,trailingSlash:O},Symbol.toStringTag,{value:"Module"}));export{J as _,C as l,M as p,O as t};
